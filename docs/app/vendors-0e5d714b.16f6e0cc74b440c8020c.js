"use strict";(self.webpackChunk_docstack_ui=self.webpackChunk_docstack_ui||[]).push([[1853],{3161:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(37709);function o(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function i(e,t){return function(e,t){return function(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}([o(e)],{type:t})}(atob(e),t)}var c=n(96676),s=n(36791),u=n(23541),a=n(6418),l=n(87689),f=n(7726);class d{constructor(){this.promise=new Promise(function(e){e()})}add(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise}finish(){return this.promise}}function h(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}async function y(e,t,n,r,o,i){const c=function(e,t){return h(e)+h(t)+"undefined"}(n,r);let s;if(!o&&(s=e._cachedViews=e._cachedViews||{},s[c]))return s[c];const u=e.info().then(async function(u){const f=u.db_name+"-mrview-"+(o?"temp":(0,l.m)(c));await(0,a.el)(e,"_local/"+i,function(e){e.views=e.views||{};let n=t;-1===n.indexOf("/")&&(n=t+"/"+t);const r=e.views[n]=e.views[n]||{};if(!r[f])return r[f]=!0,e});const d=(await e.registerDependentDatabase(f)).db;d.auto_compaction=!0;const h={name:f,db:d,sourceDB:e,adapter:e.adapter,mapFun:n,reduceFun:r};let y;try{y=await h.db.get("_local/lastSeq")}catch(e){if(404!==e.status)throw e}return h.seq=y?y.seq:0,s&&h.db.once("destroyed",function(){delete s[c]}),h});return s&&(s[c]=u),u}var g={},p=new d;function v(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function _(e,t,n){try{e.emit("error",t)}catch(e){(0,a.ue)("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),(0,a.ue)("error",t,n)}}const w=function(e,t,n,o){function l(e,t,n){try{t(n)}catch(r){_(e,r,{fun:t,doc:n})}}function h(e,t,n,r,o){try{return{output:t(n,r,o)}}catch(i){return _(e,i,{fun:t,keys:n,values:r,rereduce:o}),{error:i}}}function w(e,t){const n=(0,c.Zc)(e.key,t.key);return 0!==n?n:(0,c.Zc)(e.value,t.value)}function k(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function m(e){const t=e.value;return t&&"object"==typeof t&&t._id||e.id}function b(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&function(e){e.rows.forEach(function(e){const t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){const n=t[e];t[e].data=i(n.data,n.content_type)})})}(t),t}}function A(e,t,n,r){let o=t[e];void 0!==o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+"="+o))}function B(e){if(void 0!==e){const t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function C(e,t){const n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&(0,c.Zc)(e[n],e[r])>0)throw new f.cf("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new f.cf("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new f.cf("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){const n=function(e){if(e){if("number"!=typeof e)return new f.cf(`Invalid value for integer: "${e}"`);if(e<0)return new f.cf(`Invalid value for positive integer: "${e}"`)}}(e[t]);if(n)throw n})}function q(e){return function(t){if(404===t.status)return e;throw t}}function O(e){const t="string"==typeof e?e:e.name;let n=g[t];return n||(n=g[t]=new d),n}async function D(e,n){return(0,f.An)(O(e),function(){return async function(e,n){let o,i,s;const u=t(e.mapFun,function(e,t){const n={id:i._id,key:(0,c.l5)(e)};null!=t&&(n.value=(0,c.l5)(t)),o.push(n)});let h=e.seq||0;function y(t,n){return function(){return function(e,t,n){var o="_local/lastSeq";return e.db.get(o).catch(q({_id:o,seq:0})).then(function(o){var i=(0,f.t8)(t);return Promise.all(i.map(function(n){return async function(e,t,n){const o="_local/doc_"+e,i={_id:o,keys:[]},c=n.get(e),s=c[0],u=c[1],a=await(function(e){return 1===e.length&&/^1-/.test(e[0].rev)}(u)?Promise.resolve(i):t.db.get(o).catch(q(i))),l=await function(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):Promise.resolve({rows:[]})}(a);return function(e,t){const n=[],o=new r.N;for(let e=0,r=t.rows.length;e<r;e++){const r=t.rows[e].doc;if(r&&(n.push(r),o.add(r._id),r._deleted=!s.has(r._id),!r._deleted)){const e=s.get(r._id);"value"in e&&(r.value=e.value)}}const i=(0,f.t8)(s);return i.forEach(function(e){if(!o.has(e)){const t={_id:e},r=s.get(e);"value"in r&&(t.value=r.value),n.push(t)}}),e.keys=(0,f.sb)(i.concat(e.keys)),n.push(e),n}(a,l)}(n,e,t)})).then(function(t){var r=(0,a.Bq)(t);return o.seq=n,r.push(o),e.db.bulkDocs({docs:r})}).then(()=>function(e){return e.sourceDB.get("_local/purges").then(function(t){const n=t.purgeSeq;return e.db.get("_local/purgeSeq").then(function(e){return e._rev}).catch(function(e){if(404!==e.status)throw e}).then(function(t){return e.db.put({_id:"_local/purgeSeq",_rev:t,purgeSeq:n})})}).catch(function(e){if(404!==e.status)throw e})}(e))})}(e,t,n)}}let g=0;const p={view:e.name,indexed_docs:g};e.sourceDB.emit("indexing",p);const v=new d;async function _(){return function(t,c){var a=t.results;if(!a.length&&!c.length)return;for(let e of c)if(a.findIndex(function(t){return t.id===e.docId})<0){const t={_id:e.docId,doc:{_id:e.docId,_deleted:1},changes:[]};e.doc&&(t.doc=e.doc,t.changes.push({rev:e.doc._rev})),a.push(t)}var f=function(t){const n=new r.T;for(let r=0,c=t.length;r<c;r++){const c=t[r];if("_"!==c.doc._id[0]){o=[],i=c.doc,i._deleted||l(e.sourceDB,u,i),o.sort(w);const t=k(o);n.set(c.doc._id,[t,c.changes])}h=c.seq}return n}(a);v.add(y(f,h)),g+=a.length;const d={view:e.name,last_seq:t.last_seq,results_count:a.length,indexed_docs:g};return e.sourceDB.emit("indexing",d),e.sourceDB.activeTasks.update(s,{completed_items:g}),a.length<n.changes_batch_size?void 0:_()}(await e.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:h,limit:n.changes_batch_size}),await e.db.get("_local/purgeSeq").then(function(e){return e.purgeSeq}).catch(function(e){if(e&&404!==e.status)throw e;return-1}).then(function(t){return e.sourceDB.get("_local/purges").then(function(n){const r=n.purges.filter(function(e,n){return n>t}).map(e=>e.docId),o=r.filter(function(e,t){return r.indexOf(e)===t});return Promise.all(o.map(function(t){return e.sourceDB.get(t).then(function(e){return{docId:t,doc:e}}).catch(function(e){if(404!==e.status)throw e;return{docId:t}})}))}).catch(function(e){if(e&&404!==e.status)throw e;return[]})}))}function k(e){const t=new r.T;let n;for(let r=0,o=e.length;r<o;r++){const o=e[r],i=[o.key,o.id];r>0&&0===(0,c.Zc)(o.key,n)&&i.push(r),t.set((0,c.$n)(i),o),n=o.key}return t}try{await e.sourceDB.info().then(function(t){s=e.sourceDB.activeTasks.add({name:"view_indexing",total_items:t.update_seq-h})}),await _(),await v.finish(),e.seq=h,e.sourceDB.activeTasks.remove(s)}catch(t){e.sourceDB.activeTasks.remove(s,t)}}(e,n)})()}function I(e,t){return(0,f.An)(O(e),function(){return async function(e,t){let o;const i=e.reduceFun&&!1!==t.reduce,s=t.skip||0;async function u(t){t.include_docs=!0;const n=await e.db.allDocs(t);return o=n.total_rows,n.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){const t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}const t=(0,c.d0)(e.doc._id);return{key:t[0],id:t[1],value:"value"in e.doc?e.doc.value:null}})}async function l(u){let a;if(a=i?function(e,t,r){0===r.group_level&&delete r.group_level;const o=r.group||r.group_level,i=n(e.reduceFun),s=[],u=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;t.forEach(function(e){const t=s[s.length-1];let n=o?e.key:null;if(o&&Array.isArray(n)&&(n=n.slice(0,u)),t&&0===(0,c.Zc)(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);s.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(let n=0,r=s.length;n<r;n++){const r=s[n],o=h(e.sourceDB,i,r.keys,r.values,!1);if(o.error&&o.error instanceof f.Oh)throw o.error;t.push({value:o.error?null:o.output,key:r.groupKey})}return{rows:k(t,r.limit,r.skip)}}(e,u,t):void 0===t.keys?{total_rows:o,offset:s,rows:u}:{total_rows:o,offset:s,rows:k(u,t.limit,t.skip)},t.update_seq&&(a.update_seq=e.seq),t.include_docs){const n=(0,f.sb)(u.map(m)),o=await e.sourceDB.allDocs({keys:n,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary});var l=new r.T;return o.rows.forEach(function(e){l.set(e.id,e.doc)}),u.forEach(function(e){var t=m(e),n=l.get(t);n&&(e.doc=n)}),a}return a}if(void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys),void 0!==t.keys){const e=t.keys.map(function(e){const n={startkey:(0,c.$n)([e]),endkey:(0,c.$n)([e,{}])};return t.update_seq&&(n.update_seq=!0),u(n)}),n=await Promise.all(e);return l((0,a.Bq)(n))}{const e={descending:t.descending};let n,r;if(t.update_seq&&(e.update_seq=!0),"start_key"in t&&(n=t.start_key),"startkey"in t&&(n=t.startkey),"end_key"in t&&(r=t.end_key),"endkey"in t&&(r=t.endkey),void 0!==n&&(e.startkey=t.descending?(0,c.$n)([n,{}]):(0,c.$n)([n])),void 0!==r){let n=!1!==t.inclusive_end;t.descending&&(n=!n),e.endkey=(0,c.$n)(n?[r,{}]:[r])}if(void 0!==t.key){const n=(0,c.$n)([t.key]),r=(0,c.$n)([t.key,{}]);e.descending?(e.endkey=n,e.startkey=r):(e.startkey=n,e.endkey=r)}return i||("number"==typeof t.limit&&(e.limit=t.limit),e.skip=s),l(await u(e))}}(e,t)})()}return{query:function(t,n,r){const i=this;"function"==typeof n&&(r=n,n={}),n=n?function(e){return e.group_level=B(e.group_level),e.limit=B(e.limit),e.skip=B(e.skip),e}(n):{},"function"==typeof t&&(t={map:t});const c=Promise.resolve().then(function(){return async function(t,n,r){if("function"==typeof t._query)return function(e,t,n){return new Promise(function(r,o){e._query(t,n,function(e,t){if(e)return o(e);r(t)})})}(t,n,r);if((0,a.Vx)(t))return async function(e,t,n){let r,o,i=[],c="GET";if(A("reduce",n,i),A("include_docs",n,i),A("attachments",n,i),A("limit",n,i),A("descending",n,i),A("group",n,i),A("group_level",n,i),A("skip",n,i),A("stale",n,i),A("conflicts",n,i),A("startkey",n,i,!0),A("start_key",n,i,!0),A("endkey",n,i,!0),A("end_key",n,i,!0),A("inclusive_end",n,i),A("key",n,i,!0),A("update_seq",n,i),i=i.join("&"),i=""===i?"":"?"+i,void 0!==n.keys){const e=2e3,o=`keys=${encodeURIComponent(JSON.stringify(n.keys))}`;o.length+i.length+1<=e?i+=("?"===i[0]?"&":"?")+o:(c="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){const a=v(t),l=await e.fetch("_design/"+a[0]+"/_view/"+a[1]+i,{headers:new u.Lr({"Content-Type":"application/json"}),method:c,body:JSON.stringify(r)});o=l.ok;const f=await l.json();if(!o)throw f.status=l.status,(0,s.hp)(f);return f.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),new Promise(function(e){e(f)}).then(b(n))}r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()});const a=await e.fetch("_temp_view"+i,{headers:new u.Lr({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(r)});o=a.ok;const l=await a.json();if(!o)throw l.status=a.status,(0,s.hp)(l);return new Promise(function(e){e(l)}).then(b(n))}(t,n,r);const i={changes_batch_size:t.__opts.view_update_changes_batch_size||50};if("string"!=typeof n)return C(r,n),p.add(async function(){const o=await y(t,"temp_view/temp_view",n.map,n.reduce,!0,e);return(0,f.UO)(D(o,i).then(function(){return I(o,r)}),function(){return o.db.destroy()})}),p.finish();{const c=n,s=v(c),u=s[0],l=s[1],d=await t.get("_design/"+u);if(!(n=d.views&&d.views[l]))throw new f.m_(`ddoc ${d._id} has no view named ${l}`);o(d,l),C(r,n);const h=await y(t,c,n.map,n.reduce,!1,e);return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&(0,a.dY)(function(){D(h,i)}),I(h,r)):(await D(h,i),I(h,r))}}(i,t,n)});return(0,f.t6)(c,r),c},viewCleanup:(0,f.Kw)(function(){const t=this;return"function"==typeof t._viewCleanup?function(e){return new Promise(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}(t):(0,a.Vx)(t)?async function(e){return(await e.fetch("_view_cleanup",{headers:new u.Lr({"Content-Type":"application/json"}),method:"POST"})).json()}(t):async function(t){try{const n=await t.get("_local/"+e),o=new r.T;Object.keys(n.views).forEach(function(e){const t=v(e),n="_design/"+t[0],i=t[1];let c=o.get(n);c||(c=new r.N,o.set(n,c)),c.add(i)});const i={keys:(0,f.t8)(o),include_docs:!0},c=await t.allDocs(i),s={};c.rows.forEach(function(e){const t=e.key.substring(8);o.get(e.key).forEach(function(r){let o=t+"/"+r;n.views[o]||(o=r);const i=Object.keys(n.views[o]),c=e.doc&&e.doc.views&&e.doc.views[r];i.forEach(function(e){s[e]=s[e]||c})})});const u=Object.keys(s).filter(function(e){return!s[e]}).map(function(e){return(0,f.An)(O(e),function(){return new t.constructor(e,t.__opts).destroy()})()});return Promise.all(u).then(function(){return{ok:!0}})}catch(e){if(404===e.status)return{ok:!0};throw e}}(t)})}}},69501:e=>{e.exports=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},99942:(e,t,n)=>{var r=n(39907);function o(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var n,r="",o=0,i=-1,c=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(i===s-1||1===c);else if(i!==s-1&&2===c){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",o=0):o=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),i=s,c=0;continue}}else if(2===r.length||1===r.length){r="",o=0,i=s,c=0;continue}t&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+e.slice(i+1,s):r=e.slice(i+1,s),o=s-i-1;i=s,c=0}else 46===n&&-1!==c?++c:c=-1}return r}var c={resolve:function(){for(var e,t="",n=!1,c=arguments.length-1;c>=-1&&!n;c--){var s;c>=0?s=arguments[c]:(void 0===e&&(e=r.cwd()),s=e),o(s),0!==s.length&&(t=s+"/"+t,n=47===s.charCodeAt(0))}return t=i(t,!n),n?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(o(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return o(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];o(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":c.normalize(e)},relative:function(e,t){if(o(e),o(t),e===t)return"";if((e=c.resolve(e))===(t=c.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var r=e.length,i=r-n,s=1;s<t.length&&47===t.charCodeAt(s);++s);for(var u=t.length-s,a=i<u?i:u,l=-1,f=0;f<=a;++f){if(f===a){if(u>a){if(47===t.charCodeAt(s+f))return t.slice(s+f+1);if(0===f)return t.slice(s+f)}else i>a&&(47===e.charCodeAt(n+f)?l=f:0===f&&(l=0));break}var d=e.charCodeAt(n+f);if(d!==t.charCodeAt(s+f))break;47===d&&(l=f)}var h="";for(f=n+l+1;f<=r;++f)f!==r&&47!==e.charCodeAt(f)||(0===h.length?h+="..":h+="/..");return h.length>0?h+t.slice(s+l):(s+=l,47===t.charCodeAt(s)&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(o(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,c=e.length-1;c>=1;--c)if(47===(t=e.charCodeAt(c))){if(!i){r=c;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');o(e);var n,r=0,i=-1,c=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,u=-1;for(n=e.length-1;n>=0;--n){var a=e.charCodeAt(n);if(47===a){if(!c){r=n+1;break}}else-1===u&&(c=!1,u=n+1),s>=0&&(a===t.charCodeAt(s)?-1===--s&&(i=n):(s=-1,i=u))}return r===i?i=u:-1===i&&(i=e.length),e.slice(r,i)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!c){r=n+1;break}}else-1===i&&(c=!1,i=n+1);return-1===i?"":e.slice(r,i)},extname:function(e){o(e);for(var t=-1,n=0,r=-1,i=!0,c=0,s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(47!==u)-1===r&&(i=!1,r=s+1),46===u?-1===t?t=s:1!==c&&(c=1):-1!==t&&(c=-1);else if(!i){n=s+1;break}}return-1===t||-1===r||0===c||1===c&&t===r-1&&t===n+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){o(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,r=e.charCodeAt(0),i=47===r;i?(t.root="/",n=1):n=0;for(var c=-1,s=0,u=-1,a=!0,l=e.length-1,f=0;l>=n;--l)if(47!==(r=e.charCodeAt(l)))-1===u&&(a=!1,u=l+1),46===r?-1===c?c=l:1!==f&&(f=1):-1!==c&&(f=-1);else if(!a){s=l+1;break}return-1===c||-1===u||0===f||1===f&&c===u-1&&c===s+1?-1!==u&&(t.base=t.name=0===s&&i?e.slice(1,u):e.slice(s,u)):(0===s&&i?(t.name=e.slice(1,c),t.base=e.slice(1,u)):(t.name=e.slice(s,c),t.base=e.slice(s,u)),t.ext=e.slice(c,u)),s>0?t.dir=e.slice(0,s-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};c.posix=c,e.exports=c}}]);