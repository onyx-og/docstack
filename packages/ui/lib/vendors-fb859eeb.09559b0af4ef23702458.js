"use strict";(self.webpackChunk_docstack_ui=self.webpackChunk_docstack_ui||[]).push([[5403],{19592:(e,t,i)=>{i.d(t,{I:()=>o});var s=i(95830);class o extends s.LN{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}},49768:(e,t,i)=>{i.d(t,{c:()=>H});var s=i(32293),o=i(35544),r=i(51767),n=i(79284),l=i(18083),d=i(6995),h=i(35380),a=i(73226),c=i(55273),_=i(52424),g=i(58161),m=i(66401),f=i(15719),u=i(85409),p=i(49693),v=i(35184),w=i(10026),b=i(92414),y=i(36972),S=i(39503),M=i(62163),D=i(69298),E=i(1393),x=i(78504),k=i(19592),C=function(e,t){return function(i,s){t(i,s,e)}};class L{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let R=class extends s.jG{constructor(e,t,i,r,l){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=r,this._viewModel=(0,c.FY)(this,void 0),this._collapsed=(0,o.un)(this,e=>this._viewModel.read(e)?.collapsed.read(e)),this._editorContentHeight=(0,c.FY)(this,500),this.contentHeight=(0,o.un)(this,e=>(this._collapsed.read(e)?0:this._editorContentHeight.read(e))+this._outerEditorHeight),this._modifiedContentWidth=(0,c.FY)(this,0),this._modifiedWidth=(0,c.FY)(this,0),this._originalContentWidth=(0,c.FY)(this,0),this._originalWidth=(0,c.FY)(this,0),this.maxScroll=(0,o.un)(this,e=>{const t=this._modifiedContentWidth.read(e)-this._modifiedWidth.read(e),i=this._originalContentWidth.read(e)-this._originalWidth.read(e);return t>i?{maxScroll:t,width:this._modifiedWidth.read(e)}:{maxScroll:i,width:this._originalWidth.read(e)}}),this._elements=(0,n.h)("div.multiDiffEntry",[(0,n.h)("div.header@header",[(0,n.h)("div.header-content",[(0,n.h)("div.collapse-button@collapseButton"),(0,n.h)("div.file-path",[(0,n.h)("div.title.modified.show-file-icons@primaryPath",[]),(0,n.h)("div.status.deleted@status",["R"]),(0,n.h)("div.title.original.show-file-icons@secondaryPath",[])]),(0,n.h)("div.actions@actions")])]),(0,n.h)("div.editorParent",[(0,n.h)("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(M.T,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=(0,S.Ud)(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=(0,S.Ud)(this.editor.getOriginalEditor()).isFocused,this.isFocused=(0,o.un)(this,e=>this.isModifedFocused.read(e)||this.isOriginalFocused.read(e)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new s.Cm),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const d=new b.$(this._elements.collapseButton,{});this._register((0,o.fm)(e=>{d.element.className="",d.icon=this._collapsed.read(e)?y.W.chevronRight:y.W.chevronDown})),this._register(d.onDidClick(()=>{this._viewModel.get()?.collapsed.set(!this._collapsed.get(),void 0)})),this._register((0,o.fm)(e=>{this._elements.editor.style.display=this._collapsed.read(e)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(e=>{const t=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(t,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(e=>{const t=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(t,void 0)})),this._register(this.editor.onDidContentSizeChange(e=>{(0,c.YY)(t=>{this._editorContentHeight.set(e.contentHeight,t),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),t),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),t)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(e=>{if(this._isSettingScrollTop)return;if(!e.scrollTopChanged||!this._data)return;const t=e.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(t)})),this._register((0,o.fm)(e=>{const t=this._viewModel.read(e)?.isActive.read(e);this._elements.root.classList.toggle("active",t)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(l.createScoped(this._elements.actions));const h=this._register(this._instantiationService.createChild(new w.a([p.fN,this._contextKeyService])));this._register(h.createInstance(E.m,this._elements.actions,x.D8.MultiDiffEditorFileToolbar,{actionRunner:this._register(new k.I(()=>this._viewModel.get()?.modifiedUri)),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("navigation")},actionViewItemProvider:(e,t)=>(0,D.rN)(h,e,t)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){function t(e){return{...e,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(this._data=e,!e)return void(0,c.YY)(e=>{this._viewModel.set(void 0,e),this.editor.setDiffModel(null,e),this._dataStore.clear()});const i=e.viewModel.documentDiffItem;if((0,c.YY)(s=>{this._resourceLabel?.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:void 0===e.viewModel.modifiedUri});let o=!1,r=!1,n=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",o=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",n=!0):(l="D",r=!0),this._elements.status.classList.toggle("renamed",o),this._elements.status.classList.toggle("deleted",r),this._elements.status.classList.toggle("added",n),this._elements.status.innerText=l,this._resourceLabel2?.setUri(o?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,s),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,s),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,e=>{e||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[t,i]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(t,i)}render(e,t,i,s){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const o=e.length-this._headerHeight,r=Math.max(0,Math.min(s.start-e.start,o));this._elements.header.style.transform=`translateY(${r}px)`,(0,c.YY)(i=>{this.editor.layout({width:t-16-2,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",r>0||i>0),this._elements.header.classList.toggle("collapsed",r===o)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};R=function(e,t,i,s){var o,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([C(3,v._Y),C(4,p.fN)],R);class I{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(0===this._unused.size)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(t=>this._itemData.get(t).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var O=i(12003),F=function(e,t){return function(i,s){t(i,s,e)}};let j=class extends s.jG{constructor(e,t,i,r,m,f){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=r,this._parentContextKeyService=m,this._parentInstantiationService=f,this._scrollableElements=(0,n.h)("div.scrollContent",[(0,n.h)("div@content",{style:{overflow:"hidden"}}),(0,n.h)("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new _.yE({forceIntegerValues:!1,scheduleAtNextAnimationFrame:e=>(0,n.PG)((0,n.zk)(this._element),e),smoothScrollDuration:100})),this._scrollableElement=this._register(new l.oO(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=(0,n.h)("div.monaco-component.multiDiffEditor",{},[(0,n.h)("div",{},[this._scrollableElement.getDomNode()]),(0,n.h)("div.placeholder@placeholder",{},[(0,n.h)("div",[(0,O.kg)("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new g.pN(this._element,void 0)),this._objectPool=this._register(new I(e=>{const t=this._instantiationService.createInstance(R,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return t.setData(e),t})),this.scrollTop=(0,o.y0)(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=(0,o.y0)(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=(0,o.rm)(this,(e,t)=>{const i=this._viewModel.read(e);if(!i)return{items:[],getItem:e=>{throw new a.D7}};const s=i.items.read(e),o=new Map;return{items:s.map(e=>{const i=t.add(new T(e,this._objectPool,this.scrollLeft,e=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+e})})),s=this._lastDocStates?.[i.getKey()];return s&&(0,c.Rn)(e=>{i.setViewState(s,e)}),o.set(e,i),i}),getItem:e=>o.get(e)}}),this._viewItems=this._viewItemsInfo.map(this,e=>e.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(e,t)=>e.reduce((e,i)=>e+i.contentHeight.read(t)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new w.a([p.fN,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(u.R.inMultiDiffEditor.key,!0),this._register((0,o.yC)((e,t)=>{const i=this._viewModel.read(e);if(i&&i.contextKeys)for(const[e,o]of Object.entries(i.contextKeys)){const i=this._contextKeyService.createKey(e,void 0);i.set(o),t.add((0,s.s)(()=>i.reset()))}}));const v=this._parentContextKeyService.createKey(u.R.multiDiffEditorAllCollapsed.key,!1);this._register((0,o.fm)(e=>{const t=this._viewModel.read(e);if(t){const i=t.items.read(e).every(t=>t.collapsed.read(e));v.set(i)}})),this._register((0,o.fm)(e=>{const t=this._dimension.read(e);this._sizeObserver.observe(t)})),this._register((0,o.fm)(e=>{const t=this._viewItems.read(e);this._elements.placeholder.classList.toggle("visible",0===t.length)})),this._scrollableElements.content.style.position="relative",this._register((0,o.fm)(e=>{const t=this._sizeObserver.height.read(e);this._scrollableElements.root.style.height=`${t}px`;const i=this._totalHeight.read(e);this._scrollableElements.content.style.height=`${i}px`;const s=this._sizeObserver.width.read(e);let o=s;const r=this._viewItems.read(e),n=(0,h.Cn)(r,(0,d.VE)(t=>t.maxScroll.read(e).maxScroll,d.U9));n&&(o=s+n.maxScroll.read(e).maxScroll),this._scrollableElement.setScrollDimensions({width:s,height:t,scrollHeight:i,scrollWidth:o})})),e.replaceChildren(this._elements.root),this._register((0,s.s)(()=>{e.replaceChildren()})),this._register(this._register((0,o.fm)(e=>{(0,c.YY)(t=>{this.render(e)})})))}render(e){const t=this.scrollTop.read(e);let i=0,s=0,o=0;const r=this._sizeObserver.height.read(e),n=m.L.ofStartAndLength(t,r),l=this._sizeObserver.width.read(e);for(const d of this._viewItems.read(e)){const h=d.contentHeight.read(e),a=Math.min(h,r),c=m.L.ofStartAndLength(s,a),_=m.L.ofStartAndLength(o,h);if(_.isBefore(n))i-=h-a,d.hide();else if(_.isAfter(n))d.hide();else{const e=Math.max(0,Math.min(n.start-_.start,h-a));i-=e;const s=m.L.ofStartAndLength(t+i,r);d.render(c,e,l,s)}s+=a+this._spaceBetweenPx,o+=h+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};j=function(e,t,i,s){var o,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([F(4,p.fN),F(5,v._Y)],j);class T extends s.jG{constructor(e,t,i,s){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=s,this._templateRef=this._register((0,c.X2)(this,void 0)),this.contentHeight=(0,o.un)(this,e=>this._templateRef.read(e)?.object.contentHeight?.read(e)??this.viewModel.lastTemplateData.read(e).contentHeight),this.maxScroll=(0,o.un)(this,e=>this._templateRef.read(e)?.object.maxScroll.read(e)??{maxScroll:0,scrollWidth:0}),this.template=(0,o.un)(this,e=>this._templateRef.read(e)?.object),this._isHidden=(0,o.FY)(this,!1),this._isFocused=(0,o.un)(this,e=>this.template.read(e)?.isFocused.read(e)??!1),this.viewModel.setIsFocused(this._isFocused,void 0),this._register((0,o.fm)(e=>{const t=this._scrollLeft.read(e);this._templateRef.read(e)?.object.setScrollLeft(t)})),this._register((0,o.fm)(e=>{const t=this._templateRef.read(e);t&&this._isHidden.read(e)&&(t.object.isFocused.read(e)||this._clear())}))}dispose(){this._clear(),super.dispose()}toString(){return`VirtualViewItem(${this.viewModel.documentDiffItem.modified?.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),s=e.selections?.map(f.L.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:s},t);const o=this._templateRef.get();o&&s&&o.object.editor.setSelections(s)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&(0,c.Rn)(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,s){this._isHidden.set(!1,void 0);let o=this._templateRef.get();if(!o){o=this._objectPool.getUnusedObj(new L(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(o,void 0);const e=this.viewModel.lastTemplateData.get().selections;e&&o.object.editor.setSelections(e)}o.object.render(e,i,t,s)}}var W=i(39292);(0,W.x1A)("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},(0,O.kg)("multiDiffEditor.headerBackground","The background color of the diff editor's header")),(0,W.x1A)("multiDiffEditor.background",W.YtV,(0,O.kg)("multiDiffEditor.background","The background color of the multi file diff editor")),(0,W.x1A)("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},(0,O.kg)("multiDiffEditor.border","The border color of the multi file diff editor"));let H=class extends s.jG{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=(0,o.FY)(this,void 0),this._viewModel=(0,o.FY)(this,void 0),this._widgetImpl=(0,o.rm)(this,(e,t)=>((0,r.b)(R,e),t.add(this._instantiationService.createInstance((0,r.b)(j,e),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register((0,o.OI)(this._widgetImpl))}};var U,P;H=function(e,t,i,s){var o,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([(U=2,P=v._Y,function(e,t){P(e,t,U)})],H)},57617:(e,t,i)=>{i.d(t,{T:()=>f,i:()=>u});var s,o=i(98340),r=i(46442),n=i(73226),l=i(22573),d=i(32293),h=i(19258),a=i(49471),c=i(85838),_=i(75189),g=i(9912),m=function(e,t){return function(i,s){t(i,s,e)}};let f=class{static{s=this}static{this._ttpTokenizer=(0,r.H)("tokenizeToString",{createHTML:e=>e})}constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new l.vl,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const s=new d.Cm,r=s.add((0,o.Gc)(e,{...this._getRenderOptions(e,s),...t},i));return r.element.classList.add("rendered-markdown"),{element:r.element,dispose:()=>s.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(e,t)=>{let i;e?i=this._languageService.getLanguageIdByLanguageName(e):this._options.editor&&(i=this._options.editor.getModel()?.getLanguageId()),i||(i=c.vH);const o=await(0,_.Yj)(this._languageService,t,i),r=document.createElement("span");if(r.innerHTML=s._ttpTokenizer?.createHTML(o)??o,this._options.editor){const e=this._options.editor.getOption(50);(0,h.M)(r,e)}else this._options.codeBlockFontFamily&&(r.style.fontFamily=this._options.codeBlockFontFamily);return void 0!==this._options.codeBlockFontSize&&(r.style.fontSize=this._options.codeBlockFontSize),r},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:t=>u(this._openerService,t,e.isTrusted),disposables:t}}}};async function u(e,t,i){try{return await e.open(t,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:p(i)})}catch(e){return(0,n.dz)(e),!1}}function p(e){return!0===e||!(!e||!Array.isArray(e.enabledCommands))&&e.enabledCommands}f=s=function(e,t,i,s){var o,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}([m(1,a.L),m(2,g.C)],f)}}]);