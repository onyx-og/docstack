(self.webpackChunk_docstack_ui=self.webpackChunk_docstack_ui||[]).push([[8792],{71856:(e,t,s)=>{"use strict";s.d(t,{nW:()=>v,Xs:()=>h,jg:()=>O});var a=s(56563),r=s(86155),i=s.n(r),n=s(57822);s(50766);class o extends(i()){constructor(e){super(e),this.db=new n.A(e.dbName)}async log(e,t){queueMicrotask((()=>{this.emit("logged",e)}));const s=await this.db.post({type:"log",log:e});s.ok||console.log("pouchdb-transport - failed to push to pouchdb",s),t()}}const c=o,l=(0,a.createLogger)({transports:[new c({dbName:"log"}),new a.transports.Console]});var d=s(97238);class u extends EventTarget{constructor(){super(),this.attributes={},this.schema={},this.schemaZOD=d.Ik({}),this.state="idle",this.triggers=[]}}const h=u,m=class{constructor(e=null,t,s,a){this.class=null}};class g extends EventTarget{constructor(){super(...arguments),this.cache={},this.listeners=[],this.modelWorker=null}}g.appVersion="0.0.1";const p=g,y=class{constructor(){}},f=["string","number","integer","reference","boolean"];var b;class w extends m{constructor(e=null,t,s,a){super(e,t,s,a),this.isPrimaryKey=()=>!!this.getModel().config.primaryKey,this.getModel=()=>this.model,this.getClass=()=>{if(this.class)return this.class;throw Error("Missing class configuration for this attribute")},this.setModel=e=>{let t=this.getModel();e=Object.assign(t||{},e),this.model=e,this.defaultValue=e.config.defaultValue},this.getType=e=>{if(this.checkTypeValidity(e))return e;throw Error("Invalid attribute type: "+e)},this.getName=()=>this.name,this.checkTypeValidity=e=>{let t=!1;return f.includes(e)&&(t=!0),t},this.getTypeConf=(e,t)=>{switch(e){case"decimal":t=Object.assign({max:null,min:null,precision:null,isArray:!1},t);break;case"integer":t=Object.assign({max:null,min:null,isArray:!1},t);break;case"string":t=Object.assign({maxLength:50,isArray:!1},t);break;default:throw new Error("Unexpected type: "+e)}return t},this.name=t,this.setModel({name:this.name,type:this.getType(s),config:this.getTypeConf(s,a)||{}}),this.class=e}static async create(e,t,s,a){const r=new b(e,t,s,a);return await b.build(r),r}}b=w,w.build=async e=>{let t=e.getClass();if(t.getSpace())return await t.addAttribute(e),e;throw new Error("Missing db configuration")};const v=w;class x extends y{constructor(e,t){if(super(),this.execute=async e=>{const t=this.classObj?this.classObj.getSpace():void 0,s=await this.run(e,this.classObj,t);return void 0===s?(console.warn(`Trigger '${this.model.name}' did not return a document. Returning the original document.`),e):s},this.executeLimited=async e=>{const t=await this.run(e);return void 0===t?(console.warn(`Trigger '${this.model.name}' did not return a document. Returning the original document.`),e):t},this.model=e,this.name=e.name,this.order=e.order,this.classObj=t,"string"!=typeof e.run)throw new Error("Trigger model's 'run' field must be a string representation of a function.");try{this.run=new Function("document","classObj","stack",`\n                "use strict";\n                // The developer's code is placed here.\n                return (async () => {\n                    ${e.run}\n                })();\n            `)}catch(t){throw new Error(`Failed to hydrate trigger '${e.name}': ${t}`)}}}var j;class k extends h{constructor(){super(),this.attributes={},this.schema={},this.schemaZOD=d.Ik({}),this.state="idle",this.logger=l.child({module:"class",className:this.name}),this.triggers=[],this.build=()=>new Promise((async(e,t)=>{let s=this.getSpace();if(s){let a=await s.addClass(this);a?(this.setModel(a),j.logger.info("build - classModel",{classModel:a}),this.setId(a._id),e(this)):t("unable to get classModel. Check logs")}else t("Missing db configuration")})),this.init=(e,t,s,a,r={})=>{this.name=t,this.description=a,this.type=s,this.setModel({type:s,_id:t,active:!0,name:t,description:a,schema:r,triggers:[]}),e&&(this.space=e)},this.hydrateSchema=e=>{const t={};for(const s in e){const a=e[s],{type:r,config:i}=a;let n;switch(r){case"string":n=d.Yj(),void 0!==i.maxLength&&(n=n.max(i.maxLength));break;case"integer":n=d.ai();break;case"boolean":n=d.zM();break;case"foreign_key":if(!i.foreignKeyClass)throw new Error(`Attribute '${s}' of type 'foreign_key' is missing a 'foreignKeyClass' in its config.`);const e=i.foreignKeyClass;n=d.Yj().refine((async e=>{const t=Array.isArray(e)?e:[e];if(0===t.length)return!0;try{const e=this.getSpace();if(e){const s=t.map((t=>e.db.get(t)));return await Promise.all(s),!0}throw new Error("Missing stack connection")}catch(e){if(404===e.status)return!1;throw e}}),{message:`One or more documents not found in class '${e}'.`});break;default:throw new Error(`Unsupported schema type: '${r}' for field '${s}'`)}!0!==i.mandatory&&(n=n.optional()),!0===i.isArray&&(n=d.YO(n)),t[s]=n}this.schemaZOD=d.Ik(t)},this.setId=e=>{this.id=e},this.getName=()=>this.name,this.getSpace=()=>this.space,this.getDescription=()=>this.description,this.getType=()=>this.type,this.getId=()=>this.id,this.buildSchema=()=>{let e={};return Object.entries(this.attributes).forEach((t=>{e[t[0]]=t[1].model})),e},this.getModel=()=>{let e=[];for(const t of this.triggers)e.push(t.model);return{_id:this.getName(),name:this.getName(),description:this.getDescription(),type:this.getType(),schema:this.buildSchema(),triggers:e,active:!0,_rev:this.model?this.model._rev:"",createTimestamp:this.model?this.model.createTimestamp:void 0}},this.setModel=e=>{j.logger.info("setModel - got incoming model",{model:e});let t=this.getModel();if((e=Object.assign(t,e)).schema){this.attributes={};for(const[t,s]of Object.entries(e.schema)){let e=new v(this,t,s.type,s.config);this.attributes[t]=e}}if(e.triggers)for(const t of e.triggers){let e=new x(t,this);this.triggers.push(e)}this.name=e.name,this.description=e.description,this.model=e,j.logger.info("setModel - model after processing",{model:e})},this.getPrimaryKeys=()=>Object.values(this.attributes).filter((e=>e.isPrimaryKey())).map((e=>e.getName())),this.getAttributes=(...e)=>{let t={};for(const s of Object.values(this.attributes))if(e.length>0)for(let a of e)null!=a&&s.getName()==a&&(t[s.name]=s);else t[s.name]=s;return t},this.hasAllAttributes=(...e)=>{let t=!1,s=this.getAttributes(...e);for(let a of Object.values(s))if(t=e.includes(a.getName()),!t)break;return t},this.hasAnyAttributes=(...e)=>{let t=!1,s=this.getAttributes(...e);for(let a of Object.values(s))if(t=e.includes(a.getName()),t)break;return t},this.hasAttribute=e=>this.hasAnyAttributes(e),this.addAttribute=async e=>{try{let t=e.getName();if(this.hasAttribute(t))return j.logger.error("Attribute with name "+t+" already exists within this Class"),this;{j.logger.info("addAttribute - adding attribute",{name:t,type:e.getModel()}),this.attributes[t]=e;let s=e.getModel();return j.logger.info("addAttribute - adding attribute to schema",{attributeModel:s}),j.logger.info("addAttribute - checking for requirements before updating class on db",{space:null!=this.space,id:this.id}),this.space&&this.id?(j.logger.info("addAttribute - updating class on db"),await this.space.updateClass(this),this):(j.logger.error("addAttribute - class not updated on db because of missing space or id"),this)}}catch(e){return j.logger.error("Falied adding attribute because: ",e),this}},this.addCard=async e=>await this.space.createDoc(null,this.getName(),this,e),this.addOrUpdateCard=async(e,t)=>{const s=j.logger.child({method:"addOrUpdateCard",args:{params:e,cardId:t}});return new Promise((async(a,r)=>{if(t)s.info("Provided document's id, performing an update"),a(await this.updateCard(t,e));else{s.info("No document id provided, checking for PKs");let t={},i=this.getPrimaryKeys();s.info("Got primary keys",{primaryKeys:i}),i.length?(i.reduce(((t,s)=>t[s]=e[s]),t),s.info("Defined filter",{filter:t}),(await this.getCards(t,void 0,0,1)).length>0?r("Other card with same PK found"):a(await this.addCard(e))):a(await this.addCard(e))}}))},this.updateCard=async(e,t)=>new Promise((async(s,a)=>{this.space?s(await this.space.createDoc(e,this.getName(),this,t)):(j.logger.info("no stack defined"),s(null))})),this.deleteCard=async e=>{const t=j.logger.child({method:"deleteCard",args:{cardId:e}});return this.space?await this.space.deleteDocument(e):(t.error("Stack is not defined"),!1)},this.getCards=async(e,t,s,a)=>{let r=Object.assign(Object.assign({},e),{type:this.name});return j.logger.info("getCards - selector",{selector:r,fields:t,skip:s,limit:a}),(await this.space.findDocuments(r,t,s,a)).docs},this.addTrigger=async(e,t)=>{const s=l.child({method:"addTrigger"});try{const e=new x(t,this);if(this.triggers.push(e),!this.space)throw new Error("Stack is not defined. Can't update class");this.setModel(),await this.space.updateClass(this)}catch(e){s.error(e)}return this},this.removeTrigger=async e=>(this.triggers=this.triggers.filter((t=>t.name!=e)),this)}}j=k,k.logger=l.child({module:"class"}),k.get=(e,t,s="class",a,r={})=>{const i=new j;return j.logger.info("Received schema",{schema:r}),i.init(e,t,s,a,r),i.space.onClassDoc(t).on("change",(e=>{console.log("onClassDoc",{change:e});const t=new CustomEvent("doc",{detail:e});i.dispatchEvent(t)})),i},k.create=async(e,t,s="class",a,r={})=>{const i=j.get(e,t,s,a,r);return await i.build(),i},k.buildFromModel=async(e,t)=>(j.logger.info("buildFromModel - Instantiate from model",{classModel:t}),t._rev?j.get(e,t.name,t.type,t.description,t.schema):await j.create(e,t.name,t.type,t.type,t.schema)),k.fetch=async(e,t)=>{let s=await e.getClassModel(t);return s?j.buildFromModel(e,s):null};const C=k;var M=s(91700),S=s(39907);const D=l.child({module:"stack"}),A={_id:{name:"_id",type:"string",config:{maxLength:100,primaryKey:!0}},type:{name:"type",type:"string",config:{maxLength:100}},createTimestamp:{name:"createTimestamp",type:"integer",config:{min:0}},updateTimestamp:{name:"updateTimestamp",type:"integer",config:{min:0}},description:{name:"description",type:"string",config:{maxLength:1e3}},active:{name:"active",type:"boolean",config:{defaultValue:!0,primaryKey:!0}}},N=Object.assign(Object.assign({},A),{schema:{name:"schema",type:"object",config:{maxLength:1e3,isArray:!0}},parentClass:{name:"parentClass",type:"foreign_key",config:{isArray:!1}}}),I=Object.assign({schema:{name:"schema",type:"object",config:{isArray:!0,defaultValue:[{name:"source",type:"foreign_key",config:{isArray:!1}},{name:"target",type:"foreign_key",config:{isArray:!1}}]}},parentDomain:{name:"parentDomain",type:"foreign_key",config:{isArray:!1}},relation:{name:"relation",type:"string",config:{maxLength:100,isArray:!1}},sourceClass:{name:"sourceClass",type:"foreign_key",config:{isArray:!0}},targetClass:{name:"targetClass",type:"foreign_key",config:{isArray:!0}}},A);class E extends p{constructor(){super(),this.listeners=[],this.modelWorker=null,this.setListeners=()=>{const e=D.child({method:"setListeners"});this.addEventListener("class-model-propagation-pending",this.onClassModelPropagationStart),this.addEventListener("class-model-propagation-complete",this.onClassModelPropagationComplete),e.info("Setting up class model worker"),this.modelWorker=new Worker(s(35951),{type:"module"}),e.info("Setting up class model changes listener");const t=this.onClassModelChanges();this.modelWorker.onmessage=t=>{const{status:s,className:a,message:r}=t.data;this.dispatchEvent(new CustomEvent("class-model-propagation-complete",{detail:{className:a,success:"success"===s,message:r}})),"error"===s&&e.error(`Model worker error for class '${a}': ${r}`)},this.listeners.push(t)},this.removeAllListeners=()=>{this.removeEventListener("class-model-propagation-pending",this.onClassModelPropagationStart),this.removeEventListener("class-model-propagation-complete",this.onClassModelPropagationComplete),this.listeners=[]},this.onClassModelPropagationStart=e=>{const t=D.child({method:"onClassModelPropagationStart",args:{event:e}}),s=e.detail.className;this.addClassLock(s).then((()=>{t.info(`Lock created successfully for class: '${s}'`)})).catch((e=>{t.error(`Error creating lock for '${s}': ${e}`)}))},this.onClassModelPropagationComplete=e=>{const t=D.child({method:"onClassModelPropagationComplete",args:{event:e}}),s=e.detail.className;this.clearClassLock(s).then((()=>{t.info(`Lock removed successfully for class: '${s}'`)})).catch((e=>{t.error(`Error removing lock for '${s}': ${e}`)}))},this.onClassModelChanges=()=>{const e=D.child({listener:"classModelChanges"});return this.db.changes({since:"now",live:!0,include_docs:!0,filter:e=>"class"==e.type}).on("change",(async t=>{const s=t.doc,a=s.type;if(s.active){this.dispatchEvent(new CustomEvent("class-model-propagation-pending",{detail:{className:a}}));try{e.info(`Class model was updated. Clearing '${a}' from cache.`),delete this.cache[a],e.info(`Successfully cleared '${a}' from cache.`);const t=await this.db.get(a,{revs:!0}),s=t._revisions.ids;if(1==s.length)e.info(`Class '${a}' was just created. Nothing to propagate.`),this.dispatchEvent(new CustomEvent("class-model-propagation-complete",{detail:{className:a,success:!0}}));else{e.info(`Class '${a}' was updated. Dispatching task to webworker.`);const r=s[1],i=`${t._revisions.start-1}-${r}`;this.modelWorker.postMessage({command:"propagateSchema",payload:{dbName:this.getDbName(),className:a,previousRevId:i}})}}catch(t){e.error(`Error while propagating data model changes for class '${a}': ${t}`),this.dispatchEvent(new CustomEvent("class-model-propagation-complete",{detail:{className:a,success:!1,message:t}}))}}else e.info("Class was deleted. [TODO] deletion of documents belonging to its class"),this.dispatchEvent(new CustomEvent("class-model-propagation-complete",{detail:{className:a,success:!0}}))}))},this.onClassLock=e=>{const t=this.db.changes({since:"now",live:!0,include_docs:!0,filter:t=>"~lock"==t.type&&t._id==`~lock-propagation-${e}`});return this.listeners.push(t),t},this.addClassLock=async e=>{const t=D.child({method:"addClassLock",args:{className:e}});try{const s=await this.db.put({_id:`~lock-propagation-${e}`,type:"~lock"});return t.info("Adding class lock response",{response:s}),s.ok}catch(e){return t.error(`Error while adding class lock: ${e}`),!1}},this.clearClassLock=async e=>{const t=D.child({method:"clearClassLock",args:{className:e}});try{const s=await this.db.get(`~lock-propagation-${e}`);t.info("Fetched class lock",{document:s});const a=await this.db.remove(s);return t.info("Removing class lock response",{response:a}),a.ok}catch(e){return t.error(`Error while adding class lock: ${e}`),!1}},this.onClassDoc=e=>{const t=this.db.changes({since:"now",live:!0,include_docs:!0,filter:t=>t.type==e});return this.listeners.push(t),t},this.close=()=>{this.removeAllListeners()},this.getClass=async e=>{if(this.cache[e]&&Date.now()<this.cache[e].ttl)return D.info("getClass -  retrieving class from cache",{ttl:this.cache[e].ttl}),this.cache[e];const t=await C.fetch(this,e);return t&&(t.ttl=Date.now()+9e5,this.cache[e]=t),t},this.findDocuments=async(e,t,s,a)=>{const r=D.child({method:"findDocuments",args:{selector:e,fields:t,skip:s,limit:a}});e.hasOwnProperty("active")||(e.active=!0);let i=Object.keys(e);r.info("Produced index fields from selector",{indexFields:i});let n={docs:[]};try{let i=await this.db.find({selector:e,fields:t,skip:s,limit:a});return r.info("Found",{result:i,selector:e}),n={docs:i.docs,selector:e,skip:s,limit:a},n}catch(t){return r.error("findDocument - error",t),{docs:[],error:t.toString(),selector:e,skip:s,limit:a}}},this.getClassModel=async e=>{let t={type:{$eq:"class"},name:{$eq:e}};try{let e=await this.findDocument(t);if(null==e)return null;let s=e;return D.info("getClassModel - result",{result:s}),s}catch(e){throw D.info("getClassModel - error",e),new Error(e)}},this.getAllClasses=async()=>{const e=D.child({method:"getAllClasses"});e.info("Requesting");let t=await this.getAllClassModels();e.info("Received classes models",{classModels:t});let s=[];for(const a of t){e.info(`Building class "${a.name}" from model`,{classModel:a});const t=await C.buildFromModel(this,a);s.push(t)}return e.info("Completed classes build"),s},this.addClass=async e=>{let t=e.getModel();D.info("addClass - got class model",{classModel:t});let s=await this.getClassModel(t.name);if(null==s){let s=await this.createDoc(t.name,"class",e,t);return D.info("addClass - result",{result:s}),s}return s},this.updateClass=async e=>{let t=await this.createDoc(e.getId(),"class",e,e.getModel());return D.info("updateClass - result",t),t},this.validateObjectByType=async(e,t,s)=>{const a=D.child({method:"validateObjectByType",args:{obj:e,type:t,schema:s}});let r={};switch(t){case"class":r=N;break;case"domain":r=I;break;default:if(!s)try{r=(await this.getClassModel(t)).schema}catch(e){return a.error(`Failed because of error: ${e}`),!1}}if(r)return await this.validateObject(e,t,r);throw new Error("Unable to retrieve schema to validate object against")},this.createDoc=async(e,t,s,a)=>{let r=s.buildSchema();D.info("createDoc - args",{docId:e,type:t,params:a,schema:r});let i=this.db,n=null,o=!1;try{if(e){const s=await this.getDocument(e);if(D.info("retrieved doc",{existingDoc:s}),s&&s.type===t)D.info("createDoc - assigning existing doc"),n=Object.assign({},s);else{if(s&&s.type!==t)throw new Error("createDoc - Existing document type differs");o=!0,n=this.prepareDoc(e,t,a)}}else e=`${t}-${this.lastDocId+1}`,n=this.prepareDoc(e,t,a),o=!0,D.info("createDoc - generated docId",e);D.info("createDoc - doc BEFORE elaboration (i.e. merge)",{doc:n,params:a});const s=Object.assign(Object.assign(Object.assign({},n),a),{_id:e,updateTimestamp:(new Date).getTime()});D.info("createDoc - doc AFTER elaboration (i.e. merge)",{doc_:s});let r=await i.put(s);if(D.info("createDoc - Response after put",{response:r}),r.ok&&o)this.incrementLastDocId(),e=r.id;else{if(!r.ok)throw new Error("createDoc - error:"+r.ok);e=r.id}}catch(e){if("conflict"!==e.name)throw D.info("createDoc - Problem while putting doc",{error:e,document:n}),new Error("createDoc - Problem while putting doc"+e);D.info("createDoc - conflict! Ignoring..")}return n},this.deleteDocument=async e=>{const t=D.child({method:"deleteDocument",args:{_id:e}}),s=await this.db.get(e);if(!s)return t.error("Found no document with given id"),!1;try{return await this.db.put(Object.assign(Object.assign({},s),{active:!1})),!0}catch(e){return t.error(`Error while deleting document: ${e}`,{document:s}),!1}},this.cache={}}async initialize(e,t){this.connection=e,this.options=t;let a=(await Promise.all([s.e(997),s.e(4500),s.e(2291),s.e(6571),s.e(9104),s.e(1368),s.e(1929),s.e(1151),s.e(3462),s.e(3345),s.e(3245),s.e(3797),s.e(6849),s.e(730),s.e(3643),s.e(8959),s.e(4635),s.e(77),s.e(5858),s.e(5582),s.e(5699),s.e(2708),s.e(5316),s.e(6556),s.e(799),s.e(7536),s.e(3765),s.e(6931),s.e(8984),s.e(9589),s.e(5403),s.e(2290),s.e(5495),s.e(5584),s.e(5840),s.e(873),s.e(4289),s.e(9761),s.e(4772),s.e(6916),s.e(5014),s.e(8613),s.e(9681),s.e(5850),s.e(5695),s.e(8951),s.e(1502),s.e(1748),s.e(1851),s.e(325),s.e(6055),s.e(6748),s.e(5391),s.e(9683),s.e(7243),s.e(5758),s.e(6891),s.e(9765),s.e(1871),s.e(8451),s.e(8349),s.e(6052),s.e(689),s.e(4669),s.e(9530),s.e(646),s.e(9329)]).then(s.bind(s,60273))).default;if(n.A.plugin(a),null==t?void 0:t.plugins)for(let e of t.plugins)n.A.plugin(e);this.db=new n.A(e),this.cache={}}getDb(){return this.db}async getDbInfo(){return this.db.info()}getDbName(){return this.db.name}static async create(e,t){const s=new E;return await s.initialize(e,t),await s.initdb(),s}async getLastDocId(){let e=0;try{e=(await this.db.get("lastDocId")).value}catch(t){if("not_found"===t.name)return D.info("getLastDocId - not found. Must be first initialization."),e;D.error("checkdb - something went wrong",{error:t})}return e}async getSystem(){try{return await this.db.get("~system")}catch(e){if("not_found"===e.name)return D.info("get System - not found",e),null;throw D.error("getSystem - something went wrong",{error:e}),new Error(e)}}async loadPatches(){let e="patch";S.env.BUILDING&&(e="patch");try{let t=Number(this.patchCount);D.info(`loadPatches - preparing to load ${t} patches`);let s=await Promise.all(Array.from({length:t}).map(((t,s)=>{var a=`${s}`.padStart(3,"0"),r=`${e}/patch-${a}.json`;return D.info("loadPatches - loading patch from path",{path:r}),(0,M.importJsonFile)(r)})));return s=s.map((e=>(D.info("loadPatches - Parsing patch",{patch:e}),e))),D.info("loadPatches - Successfully loaded patches"),D.info("loadPatches - patches",{patches:s}),s}catch(e){throw D.error("loadPatches - something went wrong",e),new Error(e)}}async applyPatch(e){try{return D.info("applyPatch - attempting to apply patch",{patch:e}),await this.db.bulkDocs(e.docs),D.info("applyPatch - Successfully applied patch",{version:e.version}),e.version}catch(e){throw D.error("applyPatch - something went wrong",e),new Error(e)}}async applyPatches(e){let t=e;try{this.patchCount=(0,M.countPatches)();const s=await this.loadPatches(),a=e?s.findIndex((t=>t.version===e))+1:0;if(D.info(`applyPatches - Starting to apply patches from index ${a}`),-1===a||a===s.length)return D.info("applyPatches - No patches to apply"),e;let r=s.slice(a);for(let e of r)t=await this.applyPatch(e);return D.info("applyPatches - Successfully applied patches till version",{version:t}),t}catch(e){throw D.error("applyPatches - something went wrong",e),new Error(e)}}async checkSystem(){let e,t=await this.getSystem();const s=await this.getDbInfo();if(D.info("checkSystem - current system doc",{system:t}),t){D.info("checkSystem - system doc already exists. Checking for updates",t);let a=await this.applyPatches(t.schemaVersion);e=Object.assign(Object.assign({},t),{appVersion:E.appVersion,dbInfo:s,schemaVersion:a,startupTime:(new Date).valueOf()})}else{e={_id:"~system",appVersion:E.appVersion,dbInfo:s,schemaVersion:void 0,startupTime:(new Date).valueOf()};let t=await this.applyPatches(e.schemaVersion);e.schemaVersion=t}try{await this.db.put(e)}catch(e){throw D.error("checkSystem - There was a problem while updating system",{error:e}),new Error(e)}D.info("checkSystem - updated system",{system:e})}async initdb(){return await this.initIndex(),await this.checkSystem(),this.setListeners(),this}async initIndex(){try{let e=await this.getLastDocId();if(e)D.info("initdb - db already initialized, consider purge");else{e=Number(e);let t=await this.db.put({_id:"lastDocId",value:++e});if(!t.ok)throw new Error("Got problem while putting doc"+t);this.lastDocId=e}this.lastDocId=Number(e)}catch(e){throw D.error("initdb -  something went wrong",e),new Error(e)}}async getDocument(e){let t;try{t=await this.db.get(e)}catch(e){if("not_found"===e.name)return D.info("getDocument - not found",e),null;throw D.info("getDocument - error",e),new Error(e)}return t}async getDocRevision(e){let t=null;try{let s=await this.getDocument(e);s&&(t=s._rev)}catch(e){throw D.info("getDocRevision - error",e),new Error(e)}return t}async findDocument(e,t=void 0,s=void 0,a=void 0){let r=await this.findDocuments(e,t,s,a);return r.docs.length>0?r.docs[0]:null}async getAllClassModels(){return(await this.findDocuments({type:{$eq:"class"}},["_id","name","description","schema"])).docs}async getClassModels(e){return(await this.getAllClassModels()).filter((t=>e.includes(t.name)))}async incrementLastDocId(){let e=await this.getDocRevision("lastDocId");if(e)return await this.db.put({_id:"lastDocId",_rev:e,value:++this.lastDocId}),this.lastDocId}async reset(){return await this.destroyDb(),await new Promise((e=>setTimeout(e,2e3))),await this.initialize(this.connection,this.options),await this.initdb(),this}async destroyDb(){const e=D.child({method:"destroyDb"});try{this.db.destroy(null,(()=>(e.info("Destroyed db"),!0)))}catch(t){return e.error(`Error while destroying db: ${t}`),!1}}static async clear(e){return new Promise(((t,s)=>{try{new n.A(e).destroy(null,(()=>{D.info("clear - Destroyed db"),t(!0)}))}catch(e){D.error("clear - Error while destroying db"+e),s(!1)}}))}async validateObject(e,t,s){D.info("validateObject - given args",{obj:e,schema:s});let a=!0;try{for(let a of Object.values(s)){let s=e[a.name];if(D.info("validateObject - model",{model:a,value:s}),void 0===s&&a.config.mandatory){let e=`Property ${a.name} does not exist on the object.`;throw D.error(e),new Error(e)}if(a.config.mandatory||void 0!==s)switch(a.config.defaultValue&&void 0===s&&(D.info(`Property ${a.name} is missing, setting to default value.`),e[a.name]=a.config.defaultValue,s=e[a.name]),a.type){case"string":if(!a.config.isArray&&typeof s!==a.type)return D.info(`Property ${a.name} is not of type ${a.type}.`),!1;if(a.config.isArray&&!Array.isArray(s))return D.info(`Property ${a.name} is not an array.`),!1;if(a.config){if(a.config.maxLength&&s.length>a.config.maxLength)return D.info(`Property ${a.name} is longer than ${a.config.maxLength} characters.`),!1;if(a.config.encrypted){let e;if(console.log("decryptedString",e),null===e)return D.info(`Property ${a.name} is not encrypted correctly.`),!1}if(a.config.primaryKey){D.info("primaryKey check",{type:t,model:a,value:s});let e=await this.findDocuments({type:{$eq:t},[a.name]:{$eq:s}});if(e.docs.length>0)throw D.info(`A card with property ${a.name} already exists.`,e),new Error(`A card with property ${a.name} already exists.`)}}break;case"decimal":if(a.config){if(a.config.min&&s<a.config.min)return D.info(`Property ${a.name} is less than ${a.config.min}.`),!1;if(a.config.max&&s>a.config.max)return D.info(`Property ${a.name} is greater than ${a.config.max}.`),!1}break;case"integer":if(a.config.isArray||"number"==typeof s){if(a.config.isArray&&(!Array.isArray(s)||!s.every((e=>"number"==typeof e))))return D.info(`Property ${a.name} is not an array.`),!1}else D.info(`Property ${a.name} is not of type ${a.type}.`);if(a.config){if(a.config.min&&s<a.config.min)return D.info(`Property ${a.name} is less than ${a.config.min}.`),!1;if(a.config.max&&s>a.config.max)return D.info(`Property ${a.name} is greater than ${a.config.max}.`),!1}break;case"foreign_key":if(a.config,null==await this.getDocument(s))return D.info(`Foreign key ${s} does not exist.`),!1;break;case"object":D.info("Missing json validation. Skipping for now.");break;default:throw new Error("Unexpected type received")}else{let e=`Property ${a.name} is not mandatory and does not exist on the object. Skipping validation of this attribute`;D.info(e)}}}catch(e){return D.info("validateObject - error",e),!1}return D.info("validateObject - result",{type:t,result:a}),a}prepareDoc(e,t,s){return D.info("prepareDoc - given args",{_id:e,type:t,params:s}),s._id=e,s.type=t,s.createTimestamp=(new Date).getTime(),s.active=!0,D.info("prepareDoc - after elaborations",{params:s}),s}}E.appVersion="0.0.1";const P=E,L=l.child({module:"client"});class O extends EventTarget{async initInstance(e){const t=await P.create(`db-${e}`,{plugins:[]});this.store=t,window.store=this.store,this.readyState=!0,this.dispatchEvent(new CustomEvent("ready",{detail:{stack:this.store}}))}async resetDb(){try{await this.store.reset()}catch(e){throw new Error(e)}}getStore(){return this.store}getReadyState(){return this.readyState}async reset(){try{await this.resetDb(),await this.initInstance(this.dbName)}catch(e){throw new Error(e)}}constructor(e){super(),this.clearConnection=async e=>{try{if(!e)throw new Error("Connection name not provided");await P.clear(e),L.info("Internal database cleared")}catch(e){throw new Error(e)}},this.createClass=async(e,t)=>{const s=L.child({method:"createClass"}),{type:a,description:r}=t;s.info("Args",{name:e,config:t});try{const t=await h.create(this.store,e,a,r,{});s.info(`class '${e}' created successfully.`,{classModel:t.getModel()})}catch(t){throw new Error(`Error during class '${e} creation. ${t}`)}s.info("Class created successfully")},this.createAttribute=async(e,t)=>{const s=L.child({method:"createAttribute"}),{name:a,type:r,config:i}=t;s.info(`Creating attribute for class '${e}'`,{name:a,type:r,config:i});try{let t=await this.store.getClass(e);if(!t)throw new Error(`Failed to retrieve Class '${e}'`);{let n=await v.create(t,a,r,i);s.info(`Attribute '${a}' added to class '${e}'`,{attributeModel:n.getModel()})}}catch(e){throw s.error(`Error during attribute '${a}' creation: ${e}`),new Error(`Error during attribute '${a}' creation: ${e}`)}},this.dbName=e&&e.dbName?e.dbName:"docstack",this.readyState=!1,this.initInstance(this.dbName),this.addEventListener("ready",(()=>L.info("DocStack client successfully initialized")))}}},91700:(e,t,s)=>{"use strict";s.r(t),s.d(t,{countPatches:()=>a,importJsonFile:()=>r});const a=()=>{let e=0;try{const t=s(55910);console.log("getPatchCount - Browser: counting files via require.context"),e=t.keys().length,console.log(`countPatches - total number of patches: ${e}`)}catch(e){console.log("countPatches - problem while reading patch folder",e)}return e},r=async e=>{try{return console.log("importJsonFile - Browser: importing file via require"),s(71895)(`./${e}`)}catch(e){throw console.error("Error reading JSON file:",e),e}}},13653:(e,t,s)=>{"use strict";s.d(t,{MI:()=>n,M_:()=>o,me:()=>l,Xm:()=>d,Oo:()=>c});var a=s(31085),r=s(14041),i=s(71856);const n=(0,r.createContext)(null),o=e=>{const{dbName:t,children:s}=e,o=r.useRef(null),[c,l]=(0,r.useState)(null),d=r.useCallback((()=>{l(o.current)}),[]);return(0,r.useEffect)((()=>{if(null===o.current){console.log("DocStack provider - init instance");const e=new i.jg({dbName:t});o.current=e,o.current.addEventListener("ready",d)}return()=>{o.current}}),[t,d]),(0,a.jsx)(n.Provider,{value:c,children:s})},c=()=>{const e=r.useContext(n),[t,s]=r.useState(!1),[a,i]=r.useState(),[o,c]=r.useState([]),l=r.useRef(!1);return r.useEffect((()=>e?(l.current?console.log("Already performing query"):(l.current=!0,s(!0),(async()=>{try{const t=await e.getStore().getAllClasses();t.length&&c(t)}catch(e){i(e)}finally{s(!1)}})()),()=>{c([])}):(console.error("useClassList must be used within a DocStackProvider."),void s(!1))),[e]),{loading:t,classList:o,error:a}},l=e=>{const t=r.useContext(n),[s,a]=r.useState(!1),[i,o]=r.useState(),[c,l]=r.useState(),d=r.useRef(!1);return r.useEffect((()=>t?(d.current||(d.current=!0,a(!0),(async()=>{try{const s=await t.getStore().getClass(e);s&&l(s)}catch(e){o(e)}finally{a(!1)}})()),()=>{}):(console.error("useClass must be used within a DocStackProvider."),void a(!1))),[t,e]),{loading:s,error:i,classObj:c}},d=(e,t={})=>{const s=r.useContext(n),[a,i]=r.useState(),[o,c]=r.useState([]),l=r.useRef([]),[d,u]=r.useState(!0),[h,m]=r.useState(null);return r.useEffect((()=>{if(s&&e)return(async()=>{u(!0),m(null);try{const t=s.getStore(),a=await t.getClass(e);a&&i(a)}catch(e){m(e),u(!1)}})(),()=>{};u(!1)}),[s,e]),r.useEffect((()=>{a&&(async()=>{u(!0);try{const e=await a.getCards(t);l.current=e,c(l.current)}catch(e){m(e)}finally{u(!1)}a.addEventListener("doc",(e=>{const t=e.detail.doc;if(console.log("useClassDocs - detail",{detail:e.detail}),t.active){console.log("useClassDocs - a doc was changed or added",{doc:t});const e=l.current.findIndex((e=>e._id==t._id));-1!=e?(console.log("useClassDocs - a doc was changed",{doc:t}),l.current=[...l.current.slice(0,e),t,...l.current.slice(e+1,l.current.length)]):(console.log("useClassDocs - a doc was added",{doc:t}),l.current.push(t))}else{console.log("useClassDocs - a doc was deleted",{doc:t});const e=l.current.findIndex((e=>e._id==t._id));-1!=e&&(l.current=[...l.current.slice(0,e),...l.current.slice(e+1,l.current.length)])}c([...l.current])}))})()}),[a,JSON.stringify(t)]),{docs:o,loading:d,error:h}}},35951:(e,t,s)=>{"use strict";var a=s(71856),r=s(93854),i=s(56563);const n=(0,i.createLogger)({transports:[new i.transports.Console]}).child({module:"dataModel"}),o=[];let c=!1;const l=async()=>{if(c||0===o.length)return;c=!0;const e=o.shift();if(e){const{command:t,payload:s}=e;try{if("propagateSchema"===t&&(e=>!!e.hasOwnProperty("previousRevId"))(s)){const{dbName:e,className:t,previousRevId:a}=s,i=new PouchDB(e),[o,c]=await Promise.all([i.get(t),i.get(t,{rev:a})]);n.info("Retrieved documents",{currentClassDoc:o,previousClassDoc:c});const l=r.Ui(c.schema,o.schema);if(n.info("Performed diff with results",{schemaDelta:l}),!l)return void self.postMessage({status:"success",className:o.type,message:`Schema for '${o.type}' has no changes.`});if(0===(await i.find({selector:{type:o.type}})).docs.length)return void self.postMessage({status:"success",className:o.type,message:`No documents found for class '${o.type}'.`});self.postMessage({status:"success",className:o.type})}else if("envisionSchema"===t&&(e=>!!e.hasOwnProperty("schema"))(s)){const{dbName:e,className:i,schema:o}=s,c=async e=>{const s=e.detail.stack,a=await s.getClass(i);if(!a)throw new Error("Class object could not be retrieved. Check logs");const c=null==a?void 0:a.model;if(n.info("Retrieved class model",{classModel:c}),!r.Ui(c.schema,o))return void self.postMessage({status:"success",className:c.type,message:`Schema for '${c.type}' has no changes.`});const l=await a.getCards();0!==l.length?l.map((async e=>{let t=Object.assign({},e);const s=Object.values(a.triggers);for(const e of s.filter((e=>"before"===e.order)))t=await e.executeLimited(t);for(const e of s.filter((e=>"after"===e.order)))t=await e.executeLimited(t);return t})):self.postMessage({status:"success",task:t,className:c.type,message:`No documents found for class '${c.type}'.`})};new a.jg({dbName:e}).addEventListener("ready",c)}}catch(e){self.postMessage({status:"error",className:s.className,message:`Failed to propagate schema for class '${s.className}'.`,error:e.message})}finally{c=!1,l()}}};self.onmessage=e=>{o.push(e.data),l()}},43820:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>c,iD:()=>n,ri:()=>o,lp:()=>i});var a=s(50523);const r=async e=>{const t=await(async e=>{const t=e.replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\n/g,""),s=(e=>{const t=new ArrayBuffer(e.length),s=new Uint8Array(t);for(let t=0,a=e.length;t<a;t++)s[t]=e.charCodeAt(t);return t})(window.atob(t));return window.crypto.subtle.importKey("spki",s,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"])})("-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwqRvt+A9v05kbMv9qJFj\n4GvFhVmR2enTe0w/0y/aLrTRyqSy6GhYFW0uH2pVC94+jc9QNXMXMLfrZRhgsv6s\nsIF6+O5uQ9fJKE2MCPocYWtxG3fsb4xJK68MPgVGAQ6i4CttG+/I5gtGG6Bpuh8Z\nHQ6++zIuST9yCQ8pR2TW/Kqn9HxyeEDt95XBT1wgeqDbH5acsOn7HgDHboBhGejj\novYts/1fThDn8xCRa3TpWaYW17ZcmqePXeamX0Br8MSuXjdpLqOk4MgZbRHVjfjV\nOR3KYPcTKzBKSu/LY8q/T8VJuL109l9AdER01QVfpR67HusKWqBIebQL92jpP5F/\n6wIDAQAB\n-----END PUBLIC KEY-----\n"),s=await(async(e,t)=>{const s=new TextEncoder;return await window.crypto.subtle.encrypt({name:"RSA-OAEP"},e,s.encode(t))})(t,e);return btoa(String.fromCharCode(...new Uint8Array(s)))},i=(0,a.VP)("skipLogin"),n=(0,a.zD)("login",(async(e,t)=>{let s=await(async e=>{const t=await r(e.password);return(await fetch(`${e.serverURL}/login`,{method:"POST",body:JSON.stringify({username:e.username,password:t}),mode:"cors",headers:{"Content-Type":"application/json"}})).json()})(e);return s.success?s:t.rejectWithValue(s)})),o=(0,a.zD)("logout",(async(e,t)=>{})),c=(0,a.vy)({isAuthenticated:!1,isAnonymous:!1},(e=>{e.addCase(n.fulfilled,((e,t)=>{e.isAuthenticated=!0})).addCase(n.rejected,((e,t)=>{console.error(t.error)})).addCase(o.fulfilled,((e,t)=>{e.isAuthenticated=!1,e.isAnonymous=!1})).addCase(o.rejected,((e,t)=>{console.error(t.error)})).addCase(i,((e,t)=>{e.isAnonymous=!0}))}))},85288:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(50523);const r=(0,a.VP)("setQuery"),i=(0,a.vy)({query:""},(e=>{e.addCase(r,((e,t)=>{e.query=t.payload}))}))},92749:(e,t,s)=>{"use strict";s.a(e,(async(e,t)=>{try{var a=s(31085),r=s(14041),i=s(25873),n=s(43705),o=s(43808),c=s(4002),l=s(73657),d=s(13653),u=e([c]);c=(u.then?(await u)():u)[0],(0,i.H)(document.getElementById("root")).render((0,a.jsx)(r.StrictMode,{children:(0,a.jsx)(d.M_,{dbName:"client-test",children:(0,a.jsx)(n.Kq,{store:c.M,children:(0,a.jsx)(l.Kd,{children:(0,a.jsx)(o.A,{})})})})})),t()}catch(e){t(e)}}))},4002:(e,t,s)=>{"use strict";s.a(e,(async(e,a)=>{try{s.d(t,{M:()=>c});var r=s(50523),i=s(85288),n=s(43820),o=s(19928);const e=await(0,o.C7)(),c=(0,r.U1)({reducer:{ui:i.A,auth:n.Ay},middleware:e=>e().concat(o.Q4),preloadedState:e});a()}catch(e){a(e)}}),1)},19928:(e,t,s)=>{"use strict";s.d(t,{C7:()=>o,LZ:()=>n,Q4:()=>c});var a=s(57822),r=s(71856);const i=new a.A("redux_state"),n=async e=>{try{const e=new r.jg({dbName:"client-test"});e.addEventListener("ready",(async()=>{const t=await r.Xs.create(e.getStore(),"Test","class","A test",{});var s=new r.nW(t,"text","string",{maxLength:50,primaryKey:!0,mandatory:!0});await r.nW.build(s),await t.addCard({text:"Hello"})}))}catch(e){console.error(e)}},o=async()=>{try{const e=await i.get("state");return console.log("loadState - loaded doc",e),e.state}catch(e){return 404===e.status?void 0:void console.error(e)}},c=e=>e=>async t=>e(t)},43808:(e,t,s)=>{"use strict";s.d(t,{A:()=>P});var a=s(31085),r=s(43705);const i=()=>(0,r.wA)(),n=r.d4;var o=s(18690),c=s(98870),l=s(14041),d=s(43820),u=s(50523),h=s(19928);const m=(0,u.zD)("testRequest",(async(e,t)=>await(async()=>{var e="same-origin";return console.log("doTestRequest - credentialsConfig",e),(await fetch("http://localhost:5000/api/test",{method:"GET",mode:"cors",credentials:e,headers:{"Content-Type":"application/json"}})).json()})())),g=(0,u.zD)("saveState",(async(e,t)=>{const s=t.getState();console.log("saveStateAction - Got state",s),await(0,h.LZ)(s)})),p=((0,u.vy)({test:"test"},(e=>{e.addCase(m.fulfilled,((e,t)=>{console.log(t.payload)})).addCase(g.fulfilled,((e,t)=>{}))})),()=>{const e=i(),[t,r]=l.useState("browser"),n=(0,l.useCallback)((s=>{if("server"!=t)throw new Error("Unexpected form data for anonymous login");e((0,d.iD)(s))}),[e,t]),o=l.useCallback((()=>{if("browser"!=t)throw new Error("should have run credentials form submit");e((0,d.lp)())}),[e,t]),u=((0,l.useCallback)((()=>{e(g(!0))}),[e]),l.useCallback((e=>{r("browser"!=e&&e?"server":"browser")}),[r])),h=l.useMemo((()=>(0,a.jsxs)(c.Form,{style:{display:"server"==t?"block":"none"},name:"login-form",submit:(0,a.jsx)(c.Button,{type:"primary",children:"Login"}),onSubmit:n,children:[(0,a.jsx)(c.TextInput,{htmlType:"text",name:"username",label:"Username",placeholder:"a.username"}),(0,a.jsx)(c.TextInput,{htmlType:"password",name:"password",label:"Password",placeholder:"a.password"}),(0,a.jsx)(c.TextInput,{htmlType:"text",name:"serverURL",label:"Server URL",placeholder:"http://localhost:5000"})]})),[t,n]);return(0,a.jsxs)("div",{className:"view-auth",children:[(0,a.jsx)("div",{className:"view-auth-hero",children:(0,a.jsx)("div",{className:"view-auth-hero-fill",style:{backgroundImage:`url("${s(31297)}")`}})}),(0,a.jsx)("div",{className:"view-auth-content",children:(0,a.jsx)(c.Card,{style:{width:"fit-content",height:"fit-content"},orientation:"vertical",padding:"m",borderRadius:"medium",headerClass:"view-auth-content-head",header:(0,a.jsx)("h1",{children:"Login"}),footer:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"target-selector",item:(0,a.jsx)(c.Select,{placeholder:"Target",options:[{value:"server",element:"Server",selected:"server"==t},{value:"browser",element:"Browser",selected:"browser"==t}],onChange:e=>u(e),multiple:!1})},{position:"right",key:"btn-browser-login",item:(0,a.jsx)(c.Button,{type:"primary",onClick:o,children:"Access"})}]}),children:h})})]})});var y=s(13653),f=s(73657);const b=e=>{const{name:t,description:s,attributes:r}=e,i=l.useMemo((()=>{let e={};return null==r||r.forEach((t=>{let s=t.model;s.config=JSON.stringify(s.config),e[t.name]=s})),e}),[r]);return(0,a.jsxs)(c.Card,{className:"class-card",header:(0,a.jsx)(c.ActionBar,{className:"dashboard-class-header",items:[{position:"left",key:"class-title",item:(0,a.jsx)("h3",{children:t})},{position:"right",key:"class-link",item:(0,a.jsx)(f.N_,{to:`/class/${t}`,children:(0,a.jsx)(c.Button,{type:"primary",iconName:"chevron-right"})})}]}),children:[(0,a.jsx)("span",{children:s}),(0,a.jsx)("h4",{children:"Attributes:"}),(0,a.jsx)(c.Table,{data:i})]})},w=()=>{const e=i(),{loading:t,error:s,classList:r}=((0,l.useCallback)((()=>{e((0,d.ri)(!0))}),[e]),(0,l.useCallback)((()=>{e(g(!0))}),[e]),(0,y.Oo)()),{Modal:n,open:o,close:u}=(0,c.useModal)({areaId:"root"}),h=l.useMemo((()=>r.length?(0,a.jsx)(c.List,{header:(0,a.jsx)(c.ActionBar,{items:[{position:"right",key:"btn-class-creation-open",item:(0,a.jsx)(c.Button,{onClick:o,type:"primary",iconName:"plus",children:"New class"})}]}),view:"list",pageSize:5,showPageCtrl:!0,type:"raw",children:r.map((e=>(0,a.jsx)(b,{name:e.name,description:e.description,attributes:Object.values(e.getAttributes())})))}):(0,a.jsx)("span",{children:"Loading"})),[t,r,s,o]);return(0,a.jsxs)("main",{className:"view-dashboard",children:[(0,a.jsx)(n,{footer:(0,a.jsx)(c.ActionBar,{items:[{position:"right",key:"btn-class-creation-close",item:(0,a.jsx)(c.Button,{type:"default",onClick:u,iconName:"close",children:"Cancel"})}]}),children:(0,a.jsx)("span",{children:"Creating class"})}),(0,a.jsx)(c.ActionBar,{items:[{item:(0,a.jsx)("h2",{children:"Classes"}),key:"body-title",position:"left"}]}),(0,a.jsx)("div",{className:"view-dash-classes-container",children:h})]})},v=e=>{const{config:t,mode:s="view"}=e,r=l.useMemo((()=>Object.entries(t).map(((e,t)=>{switch(e[0]){case"encrypted":return(0,a.jsx)(c.Toggle,{disabled:"view"==s,name:"encrypted",checked:e[1],label:"Encrypted"});case"mandatory":return(0,a.jsx)(c.Toggle,{disabled:"view"==s,name:"mandatory",checked:e[1],label:"Mandatory"});case"primaryKey":return(0,a.jsx)(c.Toggle,{disabled:"view"==s,name:"primaryKey",checked:e[1],label:"Primary key"});case"maxLength":return(0,a.jsx)(c.NumberInput,{disabled:"view"==s,name:"maxLength",value:e[1],label:"Max length"});case"max":return(0,a.jsx)(c.NumberInput,{disabled:"view"==s,name:"max",value:e[1],label:"Max"});case"min":return(0,a.jsx)(c.NumberInput,{disabled:"view"==s,name:"min",value:e[1],label:"Min"});case"precision":return(0,a.jsx)(c.NumberInput,{disabled:"view"==s,name:"min",value:e[1],label:"Precision"})}}))),[t,s]),i=l.useCallback((e=>{console.log("updateAttr",e)}),[s]);return(0,a.jsx)(c.Form,{onSubmit:"view"==s?null:i,children:r})},x=e=>{const{name:t,type:s,config:r}=e,{Modal:i,open:n,close:o}=(0,c.useModal)({areaId:"root"}),{Modal:d,open:u,close:h}=(0,c.useModal)({areaId:"root"}),m=l.useCallback((()=>{console.log(`Deleting attribute '${t}'`),h()}),[t]);return(0,a.jsxs)(c.Card,{className:"list-item-attribute",children:[(0,a.jsx)(i,{title:`Attribute: ${t}`,footer:(0,a.jsx)(c.ActionBar,{items:[{position:"right",key:"btn-del-attr",item:(0,a.jsx)(c.Button,{type:"default",onClick:o,iconName:"close",children:"Cancel"})},{position:"left",key:"btn-cancel-edit-attr",item:(0,a.jsx)(c.Button,{type:"primary",onClick:u,accent:"#f5474c",iconName:"trash",children:"Delete"})}]}),children:(0,a.jsx)(v,{name:t,type:s,config:r})}),(0,a.jsx)(d,{title:"Confirmation",footer:(0,a.jsx)(c.ActionBar,{items:[{position:"right",key:"btn-cancel-del",item:(0,a.jsx)(c.Button,{onClick:h,type:"primary",iconName:"close",children:"Cancel"})},{position:"right",key:"btn-confirm-del",item:(0,a.jsx)(c.Button,{onClick:m,iconName:"check",children:"Confirm"})}]}),children:"Do you wish to delete this attribute?"}),(0,a.jsxs)(c.Accordion,{header:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"label-attr",item:(0,a.jsx)("span",{children:t})},{position:"right",key:"btn-edit-attr",item:(0,a.jsx)(c.Button,{onClick:n,className:"btn-edit-attr",iconName:"external-link",type:"primary"})},{position:"right",key:"btn-del-attr",item:(0,a.jsx)(c.Button,{onClick:u,accent:"#f5474c",className:"btn-del-attr",iconName:"trash",type:"text"})}]}),children:[(0,a.jsx)("span",{children:s}),(0,a.jsx)(v,{name:t,type:s,config:r})]})]})},j=e=>{const{closeModal:t}=e,[s,r]=l.useState(),i=l.useCallback((e=>{r(e||void 0)}),[]),n=l.useMemo((()=>(e=>{const t=[];switch(t.push((0,a.jsx)(c.Toggle,{gridPlacement:"2",id:"mandatory",name:"mandatory",checked:!1,label:"Mandatory"},"mandatory")),t.push((0,a.jsx)(c.Toggle,{gridPlacement:"2",id:"primaryKey",name:"primaryKey",checked:!1,label:"Primary key"},"primaryKey")),t.push((0,a.jsx)(c.Toggle,{gridPlacement:"2",id:"isArray",name:"isArray",checked:!1,label:"Array"},"isArray")),e){case"string":t.push((0,a.jsx)(c.NumberInput,{gridPlacement:"3",name:"maxLength",id:"maxLength",value:50,label:"Max length."},"maxLength")),t.push((0,a.jsx)(c.NumberInput,{gridPlacement:"3",name:"encrypted",id:"encrypted",value:50,label:"Encrypted"},"encrypted")),t.push((0,a.jsx)(c.TextInput,{gridPlacement:"3",name:"defaultValue",id:"defaultValue",placeholder:"",label:"Default value"},"defaultValue"));break;case"boolean":t.push((0,a.jsx)(c.Toggle,{gridPlacement:"3",name:"defaultValue",id:"defaultValue",checked:!1,label:"Default value"},"defaultValue"));break;case"integer":case"decimal":t.push((0,a.jsx)(c.NumberInput,{gridPlacement:"3",name:"max",id:"max",label:"Max value"},"max")),t.push((0,a.jsx)(c.NumberInput,{gridPlacement:"3",name:"min",id:"maxLength",label:"Min value"},"min")),t.push((0,a.jsx)(c.NumberInput,{gridPlacement:"3",name:"defaultValue",id:"defaultValue",label:"Default value"},"defaultValue"))}return t})(s)),[s]),o=l.useCallback((e=>{console.log("Create attribute from data",{data:e}),t&&t()}),[t]);return(0,a.jsxs)(c.Form,{gridGap:"1rem 0.5rem",gridTemplate:{cols:"1fr 1fr 1fr"},onSubmit:o,children:[(0,a.jsx)(c.Select,{gridPlacement:{column:"1 / span 2"},required:!0,name:"type",id:"attrType",options:[{value:"string",element:"String"},{value:"boolean",element:"Boolean"},{value:"integer",element:"Integer"},{value:"decimal",element:"Decimal"},{value:"foreign_key",element:"Foreign key"}],placeholder:"Choose",label:"Attribute type",onChange:i}),n]})};var k=s(41655);s(10136),s(61796),s(95064),s(22664),s(59864),s(91288),s(61533);const C=e=>{const{closeModal:t}=e,[s,r]=l.useState(!1),i=l.useRef(),n=l.useRef(),o=l.useCallback((e=>{i.current||e&&(i.current=e,r(!0))}),[]),d=l.useCallback((e=>{var s;const a=null===(s=n.current)||void 0===s?void 0:s.getValue();console.log("Create trigger",{data:e,content:a}),t&&t()}),[]),u=l.useCallback((e=>!!new RegExp(/^[A-Za-z]*$/gm).test(e)||"Must be without spaces, no special characters and cannot start with a number."),[]);return l.useEffect((()=>{s&&i.current&&(n.current=k.editor.create(i.current,{value:'document["startDate"] = Date.now();\nreturn document;',language:"javascript",automaticLayout:!0}))}),[s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.Form,{gridGap:"1rem 0.5rem",gridTemplate:{cols:"1fr"},onSubmit:d,children:[(0,a.jsx)(c.TextInput,{gridPlacement:{row:"1"},required:!0,name:"name",id:"name",validator:u,placeholder:"AutoProperty",label:"Name"}),(0,a.jsx)(c.Select,{gridPlacement:{row:"2"},required:!0,name:"order",id:"order",options:[{value:"before",element:"BEFORE",selected:!0},{value:"after",element:"AFTER"}],label:"Execution order"})]}),(0,a.jsx)("div",{style:{minWidth:"30rem",minHeight:"10rem"},ref:o})]})},M=e=>{const{name:t,description:s,schema:r,type:i,_id:n}=e,o=l.useMemo((()=>r?Object.values(r).map(((e,t)=>(0,a.jsx)(x,Object.assign({},e),t))):[]),[r]),{Modal:d,open:u,close:h}=(0,c.useModal)({areaId:"root"}),{Modal:m,open:g,close:p}=(0,c.useModal)({areaId:"root"}),y=l.useCallback((()=>{window.open("https://onyx-og.github.io/docstack/docs","_blank")}),[]);return(0,a.jsxs)("section",{style:{padding:"2rem 1rem"},className:"panel-class-model",children:[(0,a.jsx)("h2",{children:t}),(0,a.jsx)("span",{children:s}),(0,a.jsx)("span",{children:i}),(0,a.jsx)(d,{title:"New attribute",footer:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"btn-attr-creation-close",item:(0,a.jsx)(c.Button,{type:"default",onClick:h,iconName:"close",children:"Cancel"})}]}),children:(0,a.jsx)(j,{closeModal:h})}),(0,a.jsx)(m,{title:"New trigger",footer:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"btn-trigg-creation-close",item:(0,a.jsx)(c.Button,{type:"default",onClick:p,iconName:"close",children:"Cancel"})},{position:"right",key:"btn-trigg-creation-help",item:(0,a.jsx)(c.Button,{type:"primary",onClick:y,iconName:"question"})}]}),children:(0,a.jsx)(C,{closeModal:p})}),(0,a.jsx)(c.List,{header:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"list-title-attr",item:(0,a.jsx)("h3",{children:"Attributes"})},{position:"right",key:"btn-add-attr",item:(0,a.jsx)(c.Button,{type:"primary",onClick:u,iconName:"plus",children:"New attribute"})}]}),type:"raw",view:"list",children:o}),(0,a.jsxs)(c.List,{header:(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"list-title-trigg",item:(0,a.jsx)("h3",{children:"Triggers"})},{position:"right",key:"btn-add-trigg",item:(0,a.jsx)(c.Button,{type:"primary",onClick:g,iconName:"plus",children:"New trigger"})}]}),type:"raw",view:"list",children:[(0,a.jsx)("div",{children:"Placeholder"}),(0,a.jsx)("div",{children:"Such empty"})]})]})},S=l.forwardRef(((e,t)=>{const{name:s,type:r,config:i,value:n,defaultMode:o="read",allowToggleMode:d=!1}=e,[u,h]=l.useState(o),m=l.useCallback((()=>{h("read"==u?"write":"read")}),[u]),g=l.useMemo((()=>{if(d)return(0,a.jsx)(c.Button,{onClick:m,iconName:"write"==u?"eye":"pencil",type:"text"})}),[u,d]);switch(r){case"string":return(0,a.jsx)(c.TextInput,{required:i.mandatory,ref:t,after:g,type:"default",htmlType:"text",disabled:"read"==u,name:s,label:s,value:n},s);case"boolean":return(0,a.jsx)(c.Toggle,{type:"switch",name:s,label:s,checked:n});default:throw new Error(`Unexpected attribute field type '${r}'`)}})),D=e=>{const{model:t,mode:s="read",doc:r,onSubmission:i}=e,{schema:n=[],name:o}=t,[d,u]=l.useState(s),h=l.useCallback((e=>{["read","read/write"].includes(e)&&u(e)}),[]),{Modal:m,open:g,close:p}=(0,c.useModal)({areaId:"root"}),{loading:f,error:b,classObj:w}=(0,y.me)(o),v=l.useCallback((e=>{w&&(console.log(`submitDoc - id: ${null==r?void 0:r._id}`),w.addOrUpdateCard(e,null==r?void 0:r._id)),i&&i(e)}),[r,w,i]),x=l.useMemo((()=>{let e=[];for(const t of Object.values(n))e.push((0,l.createElement)(S,Object.assign({defaultMode:"read/write"!=d?d:"write",allowToggleMode:"read/write"==d},t,{value:null==r?void 0:r[t.name],key:t.name})));return e}),[n,r,d]),j=l.useCallback((()=>{if(!w||!r)throw w?new Error("Missing document to delete"):new Error("Missing class instance. Check logs");w.deleteCard(r._id).then((e=>{e&&i&&i({deleted:!0})}))}),[r,w,i]),k=l.useMemo((()=>{const e=[];return r&&e.push({position:"left",key:"btn-doc-del",item:(0,a.jsx)(c.Button,{iconName:"trash",type:"primary",onClick:g})}),e.push({item:(0,a.jsx)(c.Select,{placeholder:"Mode",options:[{value:"read",element:"View",selected:"read"==d},{value:"read/write",element:"Edit",selected:"read"!=d}],onChange:e=>h(e)}),position:"left",key:"mode-selector"}),e}),[r,d,g]);return(0,a.jsxs)("div",{children:[(0,a.jsx)(m,{title:"Confirmation",footer:(0,a.jsx)(c.ActionBar,{items:[{position:"right",key:"btn-cancel-del",item:(0,a.jsx)(c.Button,{onClick:p,type:"primary",iconName:"close",children:"Cancel"})},{position:"right",key:"btn-confirm-del",item:(0,a.jsx)(c.Button,{onClick:j,iconName:"check",children:"Confirm"})}]}),children:"Do you wish to delete this document?"}),(0,a.jsx)(c.Form,{className:"form-class-doc",onSubmit:v,children:x}),(0,a.jsx)(c.ActionBar,{items:k})]})},A=e=>{const{className:t,model:s}=e,{loading:r,error:i,docs:n}=(0,y.Xm)(t),[o,d]=l.useState("view"),{Modal:u,open:h,close:m}=(0,c.useModal)({areaId:"root"}),[g,p]=l.useState(),f=l.useCallback((e=>{["view","edit"].includes(e)&&d(e)}),[]),b=l.useMemo((()=>{let e=[],t={};return n.length?e.push(...n):s&&(Object.values(s.schema).forEach((e=>{t[e.name]=void 0})),e.push(t)),e}),[s,n]),w=l.useCallback((e=>{const t=b[e];p(t),h()}),[b]),v=l.useCallback((()=>{p(void 0),h()}),[b]),x=l.useCallback((e=>{const{data:t,coords:s,mode:r}=e,i=`${s?s.concat():null}`,n=`doc-cell mode-${o}`;return(0,a.jsx)("td",{onClick:()=>{"edit"==o&&w(Number(s[0]))},className:n,onDoubleClick:()=>{"view"==o&&w(Number(s[0]))},children:null==t?void 0:t.toString()},i)}),[o,w]),j=l.useMemo((()=>{if(b&&b.length)return(0,a.jsx)(c.Table,{cellRenderer:x,data:[...b]})}),[b,x]);return(0,a.jsxs)("section",{style:{padding:"2rem 1rem"},children:[(0,a.jsx)(c.ActionBar,{items:[{position:"left",key:"target-selector",item:(0,a.jsx)(c.Select,{placeholder:"Mode",options:[{value:"view",element:"View",selected:"view"==o},{value:"edit",element:"Edit",selected:"edit"==o}],onChange:e=>f(e)})},{position:"right",key:"btn-add-doc",item:(0,a.jsx)(c.Button,{type:"primary",onClick:v,iconName:"plus-square"})}]}),(0,a.jsx)(u,{title:"Document",children:(null==s?void 0:s.schema)?(0,a.jsx)(D,{doc:g,mode:"edit"==o?"read/write":"read",model:s,onSubmission:m}):(0,a.jsx)("span",{children:"Check logs"})}),j]})},N=()=>{const{className:e}=(0,o.g)(),{loading:t,error:s,classObj:r}=(0,y.me)(e),[i,n]=l.useState("model"),d=l.useMemo((()=>{if("model"!=i){if("docs"==i)return(0,a.jsx)(A,{className:e,model:null==r?void 0:r.getModel()});throw new Error(`Unexpected panel value "${i}"`)}return r?(0,a.jsx)(M,Object.assign({},r.getModel())):t?(0,a.jsx)("span",{children:"Loading"}):s?(0,a.jsx)("span",{children:s}):void 0}),[t,s,r,i]);return(0,a.jsxs)("main",{className:"view-class",children:[(0,a.jsx)(c.Tabs,{onChange:n,tabsClass:"view-class-tabs-header",data:[{name:"model",label:"Model"},{name:"docs",label:"Documents"}]}),d]})},I=()=>{const e=l.useContext(y.MI),t=(0,o.Zp)(),s=l.useCallback((()=>{if(!e)throw new Error("reset must be used whithin DockStackProvider");e.reset(),t("/"),t(0)}),[]);return(0,a.jsx)("div",{children:(0,a.jsx)(c.Button,{type:"primary",onClick:s,children:"Reset"})})};s(94093);const E=()=>{const e=n((e=>e.auth.isAuthenticated)),t=(n((e=>e.auth.isAnonymous)),(0,o.Zp)()),r=i(),u=(0,o.zy)(),{Modal:h,state:m,open:g}=(0,c.useModal)({areaId:"root"}),p=l.useCallback((()=>{if(!e)throw new Error("Must be authenticated to logout");r((0,d.ri)(!0))}),[r]),y=l.useCallback((()=>{t(-1)}),[t]),f=l.useMemo((()=>{let e=[];return"/"==u.pathname?e.push({item:(0,a.jsx)("div",{style:{height:"40px",width:"40px",background:`url("${s(79334)}")`,backgroundSize:"contain"}}),key:"nav-logo",position:"left"}):e.push({item:(0,a.jsx)(c.Button,{type:"text",onClick:y,shape:"circle",iconName:"chevron-left"}),key:"btn-back",position:"left"}),e.push({item:(0,a.jsx)("h1",{children:"Dashboard"}),key:"dashboard-title",position:"left"},{item:(0,a.jsx)(c.Button,{type:"text",iconName:"bug",onClick:g}),key:"btn-bug",position:"right"},{item:(0,a.jsx)(c.Button,{type:"primary",onClick:p,children:"Logout"}),key:"btn-logout",position:"right"}),e}),[g,p,u]);return(0,a.jsxs)(c.Header,{style:{borderBottom:"var(--color-primary) solid .1rem"},children:[(0,a.jsx)(h,{title:"Debug Panel",children:(0,a.jsx)(I,{})}),(0,a.jsx)(c.ActionBar,{items:f})]})},P=()=>{const e=n((e=>e.auth.isAuthenticated)),t=n((e=>e.auth.isAnonymous)),s=(0,o.Zp)(),r=(0,o.zy)();l.useEffect((()=>{s(e||t?"/":"/login")}),[e,t]);const i=l.useMemo((()=>e||t?(0,a.jsx)(E,{}):null),[e,t,r]);return(0,a.jsxs)(a.Fragment,{children:[i,(0,a.jsxs)(o.BV,{children:[(0,a.jsx)(o.qh,{path:"/",element:(0,a.jsx)(w,{})}),(0,a.jsx)(o.qh,{path:"/login",element:(0,a.jsx)(p,{})}),(0,a.jsx)(o.qh,{path:"/class/:className",element:(0,a.jsx)(N,{})})]})]})}},55910:(e,t,s)=>{var a={"./patch-000.json":99578};function r(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=55910},71895:(e,t,s)=>{var a={"./":91700,"./index":91700,"./index.ts":91700,"./patch/patch-000.json":99578};function r(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=71895},5890:(e,t,s)=>{var a={"./simpleWorker":45585,"./simpleWorker.js":45585};function r(e){return Promise.resolve().then((()=>{if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s(a[e])}))}r.keys=()=>Object.keys(a),r.id=5890,e.exports=r},9204:(e,t,s)=>{var a={"./editorBaseApi":[93059],"./editorBaseApi.js":[93059],"./editorSimpleWorker":[93034],"./editorSimpleWorker.js":[93034],"./editorWorker":[90304],"./editorWorker.js":[90304],"./editorWorkerHost":[96358],"./editorWorkerHost.js":[96358],"./findSectionHeaders":[99307],"./findSectionHeaders.js":[99307],"./getIconClasses":[78148,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./getIconClasses.js":[78148,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./languageFeatureDebounce":[12060],"./languageFeatureDebounce.js":[12060],"./languageFeatures":[52230],"./languageFeatures.js":[52230],"./languageFeaturesService":[97259],"./languageFeaturesService.js":[97259],"./languageService":[83930],"./languageService.js":[83930],"./languagesAssociations":[55996],"./languagesAssociations.js":[55996],"./languagesRegistry":[66995],"./languagesRegistry.js":[66995],"./markerDecorations":[80886],"./markerDecorations.js":[80886],"./markerDecorationsService":[90011],"./markerDecorationsService.js":[90011],"./model":[64830],"./model.js":[64830],"./modelService":[40931],"./modelService.js":[40931],"./resolverService":[37042],"./resolverService.js":[37042],"./semanticTokensDto":[19376,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./semanticTokensDto.js":[19376,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./semanticTokensProviderStyling":[38620],"./semanticTokensProviderStyling.js":[38620],"./semanticTokensStyling":[82891],"./semanticTokensStyling.js":[82891],"./semanticTokensStylingService":[38148],"./semanticTokensStylingService.js":[38148],"./textModelSync/textModelSync.impl":[55526],"./textModelSync/textModelSync.impl.js":[55526],"./textModelSync/textModelSync.protocol":[45628,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./textModelSync/textModelSync.protocol.js":[45628,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./textResourceConfiguration":[41504],"./textResourceConfiguration.js":[41504],"./treeSitterParserService":[35320],"./treeSitterParserService.js":[35320],"./treeViewsDnd":[2603,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./treeViewsDnd.js":[2603,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./treeViewsDndService":[26756,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./treeViewsDndService.js":[26756,997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],"./unicodeTextModelHighlighter":[49887],"./unicodeTextModelHighlighter.js":[49887]};function r(e){if(!s.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(s.e)).then((()=>s(r)))}r.keys=()=>Object.keys(a),r.id=9204,e.exports=r},79334:e=>{"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIxNSAxNSA3MCA3MCI+DQoNCiAgPCEtLSBCb3R0b20gZG9jdW1lbnQgLS0+DQogIDxyZWN0IHg9IjIwIiB5PSIzMCIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iNCIgcnk9IjQiIGZpbGw9IiNmMGYwZjAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIzIi8+DQoNCiAgPCEtLSBNaWRkbGUgZG9jdW1lbnQgLS0+DQogIDxyZWN0IHg9IjI1IiB5PSIyNSIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iNCIgcnk9IjQiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIzIi8+DQoNCiAgPCEtLSBUb3AgZG9jdW1lbnQgLS0+DQogIDxyZWN0IHg9IjMwIiB5PSIyMCIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iNCIgcnk9IjQiIGZpbGw9IiNlOGU4ZTgiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIzIi8+DQoNCjwvc3ZnPg=="},31297:(e,t,s)=>{"use strict";e.exports=s.p+"4f59e8c4dca34ac26cc2.jpg"},11580:()=>{},86973:()=>{},49914:()=>{},14168:()=>{},62080:()=>{},78314:()=>{},35295:()=>{},51027:()=>{},69256:()=>{},62627:()=>{},78675:()=>{},99231:()=>{},99578:e=>{"use strict";e.exports=JSON.parse('{"version":"0.0.1","docs":[{"_id":"User","active":true,"name":"User","description":"A user class for secure login","type":"class","schema":{"username":{"name":"username","type":"string","config":{"primaryKey":true,"maxLength":50,"mandatory":true,"isArray":false}},"password":{"name":"password","type":"string","config":{"maxLength":50,"mandatory":true,"isArray":false}},"email":{"name":"email","type":"string","config":{"maxLength":50,"isArray":false}},"firstName":{"name":"firstName","type":"string","config":{"maxLength":50,"isArray":false}},"lastName":{"name":"lastName","type":"string","config":{"maxLength":50,"isArray":false}}}},{"_id":"UserSession","name":"UserSession","active":true,"description":"Tracks user sessions","type":"class","schema":{"username":{"name":"username","type":"string","config":{"maxLength":50,"isArray":false,"primaryKey":true,"mandatory":true}},"sessionId":{"name":"sessionId","type":"string","config":{"maxLength":200,"isArray":false,"mandatory":true}},"sessionStart":{"name":"sessionStart","type":"string","config":{"maxLength":100,"isArray":false,"mandatory":true}},"sessionStatus":{"name":"sessionStatus","type":"string","config":{"maxLength":100,"isArray":false,"mandatory":true}},"sessionEnd":{"name":"sessionEnd","type":"string","config":{"maxLength":100,"isArray":false,"mandatory":false}}}}]}')}},e=>{e.O(0,[997,4500,2291,6571,9104,1368,1929,1151,3462,3345,3245,3797,6849,730,3643,8959,4635,77,5858,5582,5699,2708,5316,6556,799,7536,3765,6931,8984,9589,5403,2290,5495,5584,5840,873,4289,9761,4772,6916,5014,8613,9681,5850,5695,8951,1502,1748,1851,325,6055,6748,5391,9683,7243,5758,6891,9765,1871,8451,8349,6052,689,4669,9530,646,9329],(()=>e(e.s=92749))),e.O()}]);